{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"[PyTorch] Tutorial_3","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyN35jwnvCNmsOKzZxLkVKvN"},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"4c689130f139474e8b123d34817e2207":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_2f718961153e4f1f8453196c857d69c7","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_33bbf11e23fb4acab7c23e882530bdfa","IPY_MODEL_b13bdd91a8534c6fafb18405acdaf226"]}},"2f718961153e4f1f8453196c857d69c7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"33bbf11e23fb4acab7c23e882530bdfa":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6e99527ed40d4e9c95da0fc3b00ed05c","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f2bf1ee0854242c3a527527dbc870559"}},"b13bdd91a8534c6fafb18405acdaf226":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_4e9b79237d15432aa836dfd6716c1580","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:20&lt;00:00, 1063640.99it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3e562f92f7ac46bea89c84f15e4fea29"}},"6e99527ed40d4e9c95da0fc3b00ed05c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f2bf1ee0854242c3a527527dbc870559":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4e9b79237d15432aa836dfd6716c1580":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3e562f92f7ac46bea89c84f15e4fea29":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"123ab39d40e64a8299c0ffeb6c74530c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b1220beb3d18423ab2fbc68f227f28cb","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_bd30eee05f154fb4aea783bb9bcb8ad4","IPY_MODEL_cd5365e2045b47339c2fd43682aa566f"]}},"b1220beb3d18423ab2fbc68f227f28cb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bd30eee05f154fb4aea783bb9bcb8ad4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ba156d5ce61340ec97dc0cf6802f3c57","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dc54634445e84e139c0ece23b23012b9"}},"cd5365e2045b47339c2fd43682aa566f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f322ead3688a4dd4a45de5185fad6f2e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:01&lt;00:00, 32673.62it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3e5e151091b1414f85d899f8a42c098c"}},"ba156d5ce61340ec97dc0cf6802f3c57":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"dc54634445e84e139c0ece23b23012b9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f322ead3688a4dd4a45de5185fad6f2e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3e5e151091b1414f85d899f8a42c098c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f645c67680fd45d5bf6181fe9b9236a5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c276e51499e54f5d91405c6fc3e2e722","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b9b04b3983d94ba689731821e9e3f155","IPY_MODEL_f98d01c21f0d4a94ac4c655363f2b29c"]}},"c276e51499e54f5d91405c6fc3e2e722":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b9b04b3983d94ba689731821e9e3f155":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_4f16c5f45bb048cf8edf703268194c0a","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ac92072872654d23ade769b6ada7eb7d"}},"f98d01c21f0d4a94ac4c655363f2b29c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_7b8d689d6e274914b2734d5d15506bbf","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:00&lt;00:00, 2317990.81it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7d62711a3e334c12ab272630894522b5"}},"4f16c5f45bb048cf8edf703268194c0a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ac92072872654d23ade769b6ada7eb7d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7b8d689d6e274914b2734d5d15506bbf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7d62711a3e334c12ab272630894522b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f533b74439534c45bfed3d7bde776f0f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_6d4c74ae249e445eaa56b14321f382de","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a493172a43714ac7a49c35af1eab08ab","IPY_MODEL_5f08ff1972d241d093b679e87aff7f08"]}},"6d4c74ae249e445eaa56b14321f382de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a493172a43714ac7a49c35af1eab08ab":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_3d70fc9b37194ae7bf3778c6b9d7e257","_dom_classes":[],"description":"  0%","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5b12b2fd84ae41e8a27b9b2b031b5bb6"}},"5f08ff1972d241d093b679e87aff7f08":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_900b0399c23644f8aa01edf40fb633e0","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/4542 [00:00&lt;?, ?it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cf87a933420d46578f3a7738cea965ba"}},"3d70fc9b37194ae7bf3778c6b9d7e257":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5b12b2fd84ae41e8a27b9b2b031b5bb6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"900b0399c23644f8aa01edf40fb633e0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"cf87a933420d46578f3a7738cea965ba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"-NGRl4FoAHfs","colab_type":"text"},"source":["# Multi Linear Regression"]},{"cell_type":"markdown","metadata":{"id":"TxaODLrFCgXQ","colab_type":"text"},"source":["#### Multivariate Linear Regression : Manually"]},{"cell_type":"code","metadata":{"id":"FajPJiZ2CTET","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599875984892,"user_tz":-540,"elapsed":5102,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim"],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"id":"NyENEmWeCe0Z","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1599876033185,"user_tz":-540,"elapsed":856,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"a2b1d546-3eab-4082-a877-650d9599d979"},"source":["torch.manual_seed(0)"],"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<torch._C.Generator at 0x7f30364c50c0>"]},"metadata":{"tags":[]},"execution_count":2}]},{"cell_type":"code","metadata":{"id":"LLXWCDXXCucl","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599877530472,"user_tz":-540,"elapsed":942,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["x_train=100*torch.randn((500,10))\n","y_train=100*torch.randn((500,1))"],"execution_count":46,"outputs":[]},{"cell_type":"code","metadata":{"id":"doGoBCyRC-CG","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599877531531,"user_tz":-540,"elapsed":637,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["w=torch.zeros((10,1),requires_grad=True)\n","b=torch.zeros(1,requires_grad=True)"],"execution_count":47,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Nfbe1eCVFGJZ","colab_type":"text"},"source":["6. 경사 하강법 구현하기\n","이제 경사 하강법을 구현합니다. 아래의 'SGD'는 경사 하강법의 일종입니다. lr은 학습률(learning rate)를 의미합니다.\n","학습 대상인 W와 b가 SGD의 입력이 됩니다.\n","\n","optimizer = optim.SGD([W, b], lr=0.01)\n","optimizer.zero_grad()를 실행하므로서 미분을 통해 얻은 기울기를 0으로 초기화합니다. 기울기를 초기화해야만 새로운 가중치 편향에 대해서 새로운 기울기를 구할 수 있습니다. 그 다음 cost.backward() 함수를 호출하면 가중치 W와 편향 b에 대한 기울기가 계산됩니다. 그 다음 경사 하강법 최적화 함수 opimizer의 .step() 함수를 호출하여 인수로 들어갔던 W와 b에서 리턴되는 변수들의 기울기에 학습률(learining rate) 0.01을 곱하여 빼줌으로서 업데이트합니다.\n","\n",">gradient를 0으로 초기화\n","\n","optimizer.zero_grad() \n","\n",">비용 함수를 미분하여 gradient 계산\n","\n","cost.backward() \n","\n",">W와 b를 업데이트\n","\n","optimizer.step() "]},{"cell_type":"code","metadata":{"id":"zn3q0qtCEYG_","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1599877534037,"user_tz":-540,"elapsed":1081,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"7ba99823-cf80-469c-c381-4fb51136ceac"},"source":["# optimizer 설정\n","optimizer = optim.SGD([w, b], lr=1e-4)\n","\n","nb_epochs = 50\n","for epoch in range(nb_epochs + 1):\n","\n","    # H(x) 계산\n","    # 편향 b는 브로드 캐스팅되어 각 샘플에 더해집니다.\n","    hypothesis = x_train.matmul(w) + b\n","\n","    # cost 계산\n","    cost = torch.mean((hypothesis - y_train) ** 2)\n","\n","    # cost로 H(x) 개선\n","    optimizer.zero_grad()\n","    cost.backward()\n","    optimizer.step()\n","\n","    if (epoch % 10)==0:\n","      print('Epoch {:4d}/{} hypothesis: {} Cost: {:.6f}'.format(\n","        epoch, nb_epochs, hypothesis.squeeze().detach(), cost.item()\n","    ))\n"],"execution_count":48,"outputs":[{"output_type":"stream","text":["Epoch    0/50 hypothesis: tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]) Cost: 9891.582031\n","Epoch   10/50 hypothesis: tensor([-2.7032e+02, -1.5524e+02,  2.1730e+02,  1.3396e+02, -4.1486e+01,\n","         1.0239e+02, -3.7543e+02,  4.1301e+02,  1.8019e+02, -2.9957e+02,\n","         2.7828e+02,  7.6082e+01,  2.1848e+02,  1.2515e+02,  9.0578e+01,\n","         2.6196e+02,  1.2829e+02, -6.5870e+01, -1.0563e+02,  2.7369e+02,\n","         8.6147e+01, -4.5547e+02, -3.6423e+02,  1.7593e+02,  6.9114e+02,\n","        -2.9789e+01, -3.6896e+02, -5.9917e+02,  4.3165e+02, -2.3526e+02,\n","         2.2772e+02,  9.1019e+01,  1.9127e+02,  1.5481e+02,  2.5542e+02,\n","         2.0899e+02, -2.8331e+02,  2.5757e+02,  3.7134e+02,  1.4840e+01,\n","        -2.8073e+02,  3.1465e+02, -3.3529e+02, -5.1454e+02,  2.3075e+02,\n","         9.1792e+01,  3.1882e+02,  1.9193e+02, -4.1999e+02, -4.6421e+02,\n","         2.4576e+02, -2.5742e+02, -1.6923e+02,  1.2666e+02, -1.5243e+02,\n","        -3.8433e+02,  1.2216e+02,  5.0303e+01, -3.4532e+02, -8.6027e+01,\n","         1.6997e+01, -6.1035e+01, -2.2715e+01,  5.3855e+01, -2.3157e+02,\n","         2.2549e+02,  1.7415e+02, -1.6183e+02,  5.5597e+01,  4.6759e+02,\n","        -2.4993e+02,  3.0333e+02, -1.7155e+02,  6.5310e+02,  1.4758e+02,\n","         2.1879e+02,  7.2663e+02, -1.1872e+02, -4.2811e+02, -8.2588e+01,\n","        -4.9686e+01,  8.4189e+01, -1.8508e+02,  1.2209e+01, -5.4864e+00,\n","         2.4452e+02, -6.7867e+02, -2.9469e+02,  1.3537e+02, -4.1471e+02,\n","         2.8728e+02,  4.1827e+01,  1.3986e+02, -2.7576e+02, -1.5083e+02,\n","        -4.7282e+02, -1.0738e+02, -1.9997e+01, -2.9444e+02,  4.6846e+02,\n","         2.2524e+01,  6.0863e+02, -4.7012e+01,  3.9947e+02,  8.5095e+01,\n","         3.4787e+02, -2.4198e+02, -2.6073e+02,  7.7670e+01,  1.2136e+01,\n","        -4.7264e+00,  1.3920e+00, -4.5025e+02,  2.2202e+02,  3.5998e+02,\n","        -2.8343e+01,  1.7181e+02,  2.4419e+01,  2.2449e+02,  4.0881e+02,\n","         4.8302e+02, -2.9018e+02, -2.5971e+02,  2.9667e+02,  1.3565e+02,\n","        -1.3867e+02, -1.9575e+02,  5.7449e+01,  4.0580e+02, -4.0738e+02,\n","        -9.8258e+01, -4.2974e+02, -1.5464e+02, -1.7620e+02, -4.7162e+02,\n","        -9.6786e+01,  3.2525e+02,  7.4853e+01, -5.4225e+02, -3.3784e+01,\n","         6.5880e+01, -1.6529e+02,  6.0420e+01, -2.7441e+02, -6.6304e+01,\n","        -4.0521e+02, -6.8022e+01, -2.9666e+02, -5.3150e+01,  9.5475e+02,\n","        -1.4817e+02, -9.5295e+00,  8.4851e+01, -9.5587e+00, -2.3492e+02,\n","        -3.3780e+02,  4.3197e+02,  7.4282e+01,  9.0785e+01, -2.4499e+01,\n","        -1.8576e+02,  3.5819e+01,  6.6483e+01, -1.4933e+02, -1.9849e+02,\n","        -1.0273e+02,  4.1619e+01,  1.1633e+02,  7.4926e+01,  3.9141e+02,\n","        -1.7396e+01, -3.8798e+01, -3.2689e+02,  2.5662e+02,  2.8650e+02,\n","        -4.9153e+02,  6.6340e+01,  1.2688e+02,  1.6126e+02, -6.5100e+01,\n","        -1.1376e+02, -2.5641e+02,  6.6697e+01, -9.2959e+01, -7.9476e+02,\n","         2.1366e+02, -1.0474e+00,  2.2461e+02,  4.4600e+02, -2.0798e+02,\n","        -1.3554e+02,  3.6916e+02,  1.6242e+02,  2.4674e+02,  3.2259e+02,\n","         2.8954e+01, -5.3960e+02,  1.5985e+02, -4.0647e+02,  4.1087e+02,\n","         3.3130e+02,  2.9041e+02,  1.6928e+02, -1.5949e+02,  5.6098e+02,\n","        -1.4854e+02,  5.1804e+02,  1.9091e+02,  2.3619e+01,  2.0913e+02,\n","         1.5700e+02,  1.3883e+02,  8.7592e+01, -2.8075e+01, -2.7017e+02,\n","         1.2928e+02, -5.2408e+02, -4.0072e+02, -6.7531e+02,  1.3029e+02,\n","        -1.0657e+02,  2.2819e+02, -4.3356e+02,  1.7341e+02,  3.6041e+00,\n","        -3.2273e+01,  8.3580e+01,  8.9725e+00,  1.4881e+02,  1.8025e+02,\n","        -1.1716e+01,  3.3975e+02, -1.0015e+02, -2.7240e+01,  1.3317e+02,\n","        -4.3421e+01,  4.8669e+02,  3.4210e+02, -3.5842e+02,  2.8430e+02,\n","         3.6008e+02, -1.4469e+02,  3.2135e+02,  4.8050e+02,  1.2972e+02,\n","         3.1930e+02,  2.3927e+00,  1.6474e+02, -1.6793e+02, -6.9832e+01,\n","         4.1828e+02,  5.6615e+02,  1.3477e+02,  1.1436e+02,  2.5798e+01,\n","        -3.8590e+01, -2.5171e+02, -3.8185e+02, -1.6679e+02,  3.6936e+02,\n","        -1.2026e+02,  5.8955e+02, -3.3179e+01, -1.1838e+02, -2.0838e+01,\n","        -1.6759e+02,  1.1612e+02, -3.2562e+02, -3.6658e+02,  3.1785e+01,\n","        -2.2151e+02, -1.8915e+02,  5.6531e+02, -3.9260e+02,  2.4022e+02,\n","         1.0532e+02, -2.7490e+02, -1.7572e+02, -5.9960e+01, -2.0156e+02,\n","        -5.8779e+02, -1.6459e+00,  1.0351e+02, -3.2860e+02, -1.5243e+02,\n","         6.2316e+01, -9.4642e+01,  1.3406e+02,  2.0051e+02,  4.7917e+00,\n","         4.4201e+01,  7.3556e+01,  5.3801e+01,  1.5922e+01,  4.2953e+02,\n","        -3.3569e+01, -2.7927e+02, -3.6003e+01,  2.8744e+02, -2.9128e+02,\n","         2.0952e+02,  6.3181e+01,  2.8166e+02, -9.7177e+01, -3.6885e+01,\n","         4.3286e+00, -1.7551e+00, -3.8110e+02,  7.1142e+01, -9.2544e+01,\n","         3.9382e+02, -1.6539e+02,  2.4096e+02, -5.8312e+01, -9.0734e+02,\n","        -2.7777e+02,  6.9306e+01, -1.5464e+02,  7.5473e+00, -1.6915e+02,\n","        -4.0136e+02, -3.0098e+02,  3.1187e+01, -7.6750e+02, -1.8719e+02,\n","        -3.4441e+01,  1.7467e+01,  8.9709e+01,  1.3760e+02,  1.5297e+02,\n","        -3.3267e+02, -1.0011e+02, -3.9525e+02,  3.4667e+02, -2.1632e+02,\n","         7.5942e+02,  6.2347e+01, -2.4515e+02,  1.2174e+01, -3.8589e+01,\n","        -2.6077e+02, -4.5494e+02, -1.0510e+02, -5.3616e+02,  6.1483e+02,\n","        -9.3665e+02, -5.3448e+01,  1.6322e+02,  9.3465e+01, -1.3669e+02,\n","        -3.4907e+02,  4.1382e+02,  6.9848e+01,  1.0216e+01,  1.8095e+02,\n","         3.6050e+02, -2.2716e+02, -8.4555e+01, -9.6979e+01,  6.8671e+01,\n","        -1.4529e+02, -4.1209e+02, -3.5255e+02, -2.0488e+02, -1.8343e+01,\n","         6.1484e+02,  3.6098e+02,  1.2229e+02,  5.6192e+02, -1.8053e+02,\n","        -7.3524e+01, -1.3874e+02,  2.1810e+02, -1.2462e+02,  1.7932e+01,\n","        -6.6147e+01,  2.2172e+02, -5.3302e+02,  9.8915e+01,  6.6769e+01,\n","         2.5789e+02,  2.1027e+02, -2.9017e+02,  1.2373e+02, -7.3828e+01,\n","        -1.5077e+02,  5.4352e+00, -2.0189e+02, -8.4258e+01, -4.4485e+02,\n","        -1.3838e+02,  1.6464e+02,  6.8355e+02,  7.1484e+00,  3.7807e+00,\n","        -1.5253e+02,  6.8136e+01,  1.4691e+02, -3.7024e+02, -2.8271e+02,\n","        -6.1545e+00,  3.2455e+02, -6.4823e+01,  1.4216e+02, -1.5220e+02,\n","        -3.2332e+02,  4.6264e+02, -6.6574e+01, -2.6866e+02,  2.6775e+02,\n","        -1.5604e+01,  2.0181e+02, -2.2549e+02, -4.6626e+00,  2.4414e+02,\n","        -8.3960e+01, -2.2559e+02, -3.5377e+02, -2.0084e+02, -5.5112e+02,\n","         9.9780e+01, -2.6457e+02, -2.3381e+02,  2.2723e+02, -1.9373e+02,\n","         4.1747e+01,  4.9596e+02,  2.5564e+02, -3.5507e+02, -4.6779e+01,\n","         1.2968e+02,  6.0607e+01, -1.0088e+01,  4.2513e+02,  8.7468e+01,\n","         3.0474e+02, -3.7781e+01,  2.7622e+02,  3.5161e+02, -8.2275e+01,\n","        -1.9701e+02, -4.6523e+02,  3.8981e+02,  3.8526e+02, -9.8039e+01,\n","        -3.4882e+02, -2.1624e+02,  2.6472e+02,  2.2400e+02, -6.8407e+02,\n","         5.1472e+01,  3.5460e+02,  2.0665e-02,  1.2257e+02,  3.1063e+01,\n","        -2.7618e+00, -1.5754e+02, -2.2741e+02,  1.7364e+02,  3.5697e+02,\n","         7.0354e+01,  2.2613e+02, -6.7140e+02,  3.7593e+01, -1.7187e+02,\n","         3.3306e+02,  1.8496e+02,  1.1977e+02, -2.2972e+02,  7.5622e+02,\n","         1.8026e+02, -1.3390e+02, -4.0113e+02, -3.9062e+02, -2.4410e+02,\n","         3.3267e+02,  3.7489e+01,  4.2288e+02, -2.3567e+02, -1.2483e+02,\n","         4.3624e+01, -3.8931e+01, -2.8453e+02, -1.6614e+02,  2.7114e+02,\n","        -6.9187e+01,  1.7928e+02,  3.4803e+02, -1.2825e+01,  1.4052e+02,\n","         4.2122e+02,  6.5701e+02,  3.5979e+02,  1.6684e+02, -3.6607e+02,\n","         2.3053e+02,  4.9885e+01,  2.7864e+02,  6.3418e+01,  3.0737e+02]) Cost: 90998.679688\n","Epoch   20/50 hypothesis: tensor([-2.8293e+04, -1.6402e+04,  3.6208e+04,  1.6722e+04, -1.2160e+04,\n","         3.5728e+03, -2.5220e+04,  4.5428e+04,  3.0860e+04, -3.2418e+04,\n","         3.3697e+04,  9.3279e+03,  2.0025e+04,  2.1358e+04,  1.2834e+04,\n","         2.1518e+04,  7.0954e+02,  2.6357e+02, -3.4486e+03,  1.6698e+04,\n","         1.4814e+04, -5.2137e+04, -5.2637e+04,  1.8525e+04,  8.4966e+04,\n","         8.4489e+03, -2.1150e+04, -6.1809e+04,  5.4519e+04, -3.3916e+04,\n","         2.1614e+04,  1.6135e+04,  1.8401e+04,  1.5957e+04,  4.4414e+04,\n","         2.0213e+04, -3.0153e+04,  3.7442e+04,  4.8398e+04,  1.5695e+04,\n","        -2.6585e+04,  4.0673e+04, -2.2379e+04, -6.0396e+04,  4.0309e+04,\n","         1.3873e+04,  4.8782e+04,  2.6551e+04, -5.4902e+04, -5.0054e+04,\n","         3.2467e+04, -3.0759e+04, -1.5637e+04,  5.0903e+02, -1.7421e+04,\n","        -3.8843e+04,  7.8357e+03,  7.9298e+03, -4.1754e+04, -2.0896e+04,\n","         1.7383e+03, -4.3609e+03, -1.7639e+04,  2.2282e+04, -3.0883e+04,\n","         1.7127e+04,  1.8371e+04, -1.8175e+04,  8.4414e+03,  6.0098e+04,\n","        -2.8348e+04,  2.1255e+04, -2.1577e+04,  7.4117e+04,  5.4697e+03,\n","         2.1082e+04,  8.5468e+04, -1.7023e+04, -4.5124e+04, -4.8513e+03,\n","         1.8292e+03, -1.9109e+03, -1.4884e+04, -2.8890e+03, -1.1541e+04,\n","         1.2632e+04, -7.0848e+04, -3.6713e+04,  1.3066e+04, -3.9624e+04,\n","         2.9166e+04,  1.2854e+04,  6.0273e+03, -3.2354e+04, -1.6999e+04,\n","        -5.2170e+04, -2.0267e+04, -2.1423e+04, -3.3668e+04,  6.1120e+04,\n","         1.4600e+02,  7.2710e+04, -1.1024e+04,  3.6206e+04,  6.5806e+03,\n","         2.5900e+04, -2.0071e+04, -3.7626e+04, -2.3742e+03, -4.0748e+03,\n","         4.6531e+03,  3.4318e+03, -4.1111e+04,  1.4709e+04,  3.4114e+04,\n","         1.8315e+01,  2.0408e+04,  4.2975e+03,  2.8272e+04,  5.0887e+04,\n","         4.1149e+04, -2.5878e+04, -1.8589e+04,  1.9583e+04,  7.9003e+03,\n","        -2.6742e+04, -2.3410e+04,  1.2409e+04,  4.1564e+04, -5.1042e+04,\n","        -7.0489e+03, -5.8391e+04, -9.5757e+03, -8.7039e+03, -6.9010e+04,\n","        -1.9269e+04,  2.6101e+04,  5.5156e+03, -6.1575e+04, -4.7021e+03,\n","        -4.0135e+03, -1.0663e+04,  9.0963e+03, -3.1465e+04, -1.2497e+04,\n","        -4.3148e+04, -1.0904e+04, -4.1270e+04, -1.9521e+02,  9.9349e+04,\n","        -1.7492e+04,  1.1619e+04,  1.5913e+04, -1.0749e+04, -2.8436e+04,\n","        -3.6650e+04,  5.0015e+04,  2.0426e+04, -2.6485e+03,  5.4368e+03,\n","        -3.0992e+04,  1.4844e+03,  2.5371e+03, -1.7030e+04, -2.3626e+04,\n","        -1.0900e+04,  3.7230e+03,  1.1126e+04,  4.4517e+03,  4.7028e+04,\n","         1.2658e+02, -5.5568e+03, -3.8103e+04,  3.8282e+04,  4.0971e+04,\n","        -4.7941e+04, -2.6669e+03,  2.0713e+04,  1.3114e+04, -4.2296e+03,\n","        -1.7667e+04, -3.2460e+04,  1.9267e+03, -1.1700e+04, -9.6765e+04,\n","         1.7098e+04,  2.7642e+03,  2.2216e+04,  4.9510e+04, -2.8391e+04,\n","        -1.3036e+04,  2.1133e+04,  2.1609e+04,  3.2951e+04,  2.3832e+04,\n","        -3.6291e+03, -8.1225e+04,  1.2790e+04, -4.6112e+04,  5.7053e+04,\n","         3.5297e+04,  3.1816e+04,  1.1038e+04, -2.7876e+04,  6.2627e+04,\n","        -1.9904e+04,  4.7944e+04,  2.3773e+04, -1.3002e+04,  1.7364e+04,\n","         1.8491e+04,  1.2287e+04,  1.0144e+04, -1.1558e+02, -2.1022e+04,\n","         1.5902e+04, -5.6863e+04, -3.9427e+04, -7.4433e+04,  1.4665e+04,\n","        -4.2776e+03,  3.5521e+04, -5.3701e+04,  1.6177e+04,  9.0333e+02,\n","        -1.9837e+03,  5.1556e+03,  7.1277e+03,  2.3743e+04,  4.3286e+04,\n","        -1.0630e+04,  4.6629e+04, -9.5198e+03, -8.6245e+03,  8.3202e+03,\n","        -9.0192e+03,  5.4921e+04,  2.4277e+04, -3.8254e+04,  3.8968e+04,\n","         3.8359e+04, -2.2582e+04,  3.4185e+04,  4.3736e+04,  2.0056e+04,\n","         5.3560e+04,  5.3442e+03,  1.2805e+04, -2.3831e+04, -2.6101e+03,\n","         4.7553e+04,  5.8022e+04,  2.4233e+03,  3.0932e+04,  1.1230e+04,\n","        -1.8005e+04, -2.1412e+04, -5.6117e+04, -1.5471e+04,  4.1511e+04,\n","        -8.4852e+03,  7.0454e+04, -1.1634e+03, -1.5060e+04, -1.8885e+02,\n","        -1.0215e+04,  2.4251e+04, -3.7489e+04, -4.9931e+04,  2.6189e+03,\n","        -1.0601e+04, -2.5126e+04,  6.4987e+04, -5.2093e+04,  1.6866e+04,\n","         1.2937e+04, -3.7985e+04, -2.9961e+04, -1.7754e+04, -3.4082e+04,\n","        -7.0320e+04, -3.6260e+03,  1.9126e+04, -3.7470e+04, -1.5290e+04,\n","         3.3801e+03, -1.0834e+04,  3.1741e+03,  2.3535e+04,  4.8809e+03,\n","        -1.3942e+04,  3.3626e+02, -9.7670e+02,  9.9210e+03,  4.4921e+04,\n","         5.3303e+03, -3.4557e+04, -6.5703e+03,  3.4434e+04, -3.8582e+04,\n","         1.9801e+04, -2.4913e+02,  4.8416e+04, -8.1653e+03, -1.3654e+04,\n","         1.2378e+04, -8.2441e+03, -2.8457e+04,  2.1844e+04, -1.5947e+04,\n","         4.1393e+04, -3.2292e+04,  1.7150e+04, -1.7579e+04, -9.1488e+04,\n","        -3.5270e+04,  3.4698e+03,  1.1742e+04, -1.0409e+04, -1.3857e+04,\n","        -4.7524e+04, -2.6880e+04,  7.1310e+03, -8.5085e+04, -1.1144e+04,\n","        -2.9105e+03,  8.1786e+03,  2.3131e+04,  1.7997e+04,  1.5310e+04,\n","        -4.4715e+04, -2.0828e+04, -3.3473e+04,  4.2583e+04, -2.1889e+04,\n","         7.6700e+04,  5.1461e+03, -2.8573e+04,  9.8330e+03, -1.1485e+04,\n","        -1.6251e+04, -4.8032e+04, -5.9667e+03, -7.3623e+04,  6.4197e+04,\n","        -1.0035e+05, -7.2436e+03,  2.3589e+04,  1.2374e+04, -8.5657e+03,\n","        -4.5087e+04,  4.8337e+04,  1.1038e+03,  2.4366e+03,  1.3688e+04,\n","         3.8279e+04, -2.6377e+04, -1.4525e+04, -1.0635e+04, -2.2081e+01,\n","        -2.8704e+04, -4.1730e+04, -4.0643e+04, -2.0141e+04, -1.6847e+04,\n","         6.6317e+04,  4.3088e+04,  6.8856e+03,  7.3094e+04, -1.4040e+04,\n","        -8.3085e+03, -1.3855e+04,  2.4350e+04, -6.0351e+03,  2.9966e+03,\n","        -6.8539e+03,  2.6331e+04, -6.1506e+04,  1.2931e+04,  1.0371e+04,\n","         7.5371e+03,  2.4145e+04, -2.2888e+04,  1.8518e+04, -2.5000e+04,\n","        -2.1930e+04,  5.6745e+03, -2.3560e+04, -1.4788e+04, -5.1407e+04,\n","        -1.8929e+04,  2.2123e+04,  6.9986e+04, -7.9713e+03,  2.6785e+03,\n","        -1.4305e+04,  1.7732e+04,  2.0590e+04, -3.4540e+04, -2.7216e+04,\n","         5.3616e+03,  3.9888e+04, -6.7393e+03,  5.3499e+03, -9.5477e+03,\n","        -3.2923e+04,  4.6617e+04, -1.2541e+04, -3.9590e+04,  3.4068e+04,\n","        -8.4081e+03,  2.2409e+04, -1.7563e+04,  8.5249e+03,  1.7867e+04,\n","        -5.4751e+03, -2.1317e+04, -4.4836e+04, -1.9244e+04, -6.3433e+04,\n","         1.2153e+04, -4.0291e+04, -3.0522e+04,  2.7641e+04, -1.5801e+04,\n","        -1.8117e+03,  4.4160e+04,  2.6759e+04, -3.9178e+04, -6.0266e+02,\n","         2.7326e+04,  1.6927e+04, -1.5188e+04,  4.8463e+04,  1.2737e+04,\n","         1.6753e+04,  3.8008e+03,  2.4217e+04,  4.7201e+04, -2.9450e+03,\n","        -2.5009e+04, -6.4070e+04,  4.7045e+04,  3.8786e+04, -2.5420e+04,\n","        -3.2978e+04, -1.9754e+04,  2.4762e+04,  2.9949e+04, -8.6128e+04,\n","         1.9598e+03,  3.7754e+04,  2.5597e+03,  1.3576e+04,  6.5783e+03,\n","        -3.2899e+03, -2.2963e+04, -1.1925e+04,  2.2030e+04,  4.7605e+04,\n","        -5.9245e+03,  1.5419e+04, -7.2458e+04, -6.0598e+03, -2.6031e+04,\n","         3.4272e+04,  2.0835e+04,  2.1359e+04, -3.3011e+04,  8.0247e+04,\n","         1.4229e+04, -1.2753e+04, -5.0001e+04, -4.3921e+04, -1.2260e+04,\n","         3.4306e+04,  1.8683e+03,  4.8575e+04, -2.8787e+04, -3.2394e+03,\n","        -1.2438e+04,  1.0094e+04, -2.3008e+04, -1.9130e+04,  4.0595e+04,\n","         1.4098e+04,  2.4539e+04,  5.3851e+04, -8.4427e+03,  1.9395e+04,\n","         5.2492e+04,  6.7391e+04,  4.6454e+04,  1.8371e+04, -3.6177e+04,\n","         1.3291e+04,  2.2334e+04,  3.7917e+04,  9.4987e+03,  2.8520e+04]) Cost: 1032358464.000000\n","Epoch   30/50 hypothesis: tensor([-3.2356e+06, -1.9059e+06,  4.4534e+06,  1.9851e+06, -1.5527e+06,\n","         3.0371e+05, -2.6355e+06,  5.3059e+06,  3.8594e+06, -3.7916e+06,\n","         3.9456e+06,  1.0710e+06,  2.2598e+06,  2.6193e+06,  1.5337e+06,\n","         2.3667e+06, -1.3042e+05,  1.2262e+05, -2.3127e+05,  1.7240e+06,\n","         1.7798e+06, -6.1464e+06, -6.3823e+06,  2.2137e+06,  1.0073e+07,\n","         1.1675e+06, -2.0645e+06, -7.1465e+06,  6.4558e+06, -4.1291e+06,\n","         2.5177e+06,  2.0195e+06,  2.0493e+06,  1.8888e+06,  5.4605e+06,\n","         2.2579e+06, -3.5056e+06,  4.5186e+06,  5.7654e+06,  2.0579e+06,\n","        -3.0271e+06,  4.9021e+06, -2.3549e+06, -7.0775e+06,  4.9660e+06,\n","         1.6805e+06,  5.9031e+06,  3.1781e+06, -6.5326e+06, -5.8049e+06,\n","         3.8359e+06, -3.6544e+06, -1.7218e+06, -1.6871e+05, -2.0366e+06,\n","        -4.4664e+06,  8.3334e+05,  9.6819e+05, -4.9525e+06, -2.6713e+06,\n","         2.1033e+05, -4.3667e+05, -2.3320e+06,  2.8843e+06, -3.6871e+06,\n","         1.9076e+06,  2.1299e+06, -2.1220e+06,  1.0741e+06,  7.1838e+06,\n","        -3.3252e+06,  2.2375e+06, -2.5459e+06,  8.6922e+06,  4.9265e+05,\n","         2.4090e+06,  1.0078e+07, -2.0784e+06, -5.2374e+06, -4.6682e+05,\n","         3.5202e+05, -4.6476e+05, -1.6560e+06, -3.7891e+05, -1.5836e+06,\n","         1.2168e+06, -8.2068e+06, -4.3869e+06,  1.4422e+06, -4.4568e+06,\n","         3.3751e+06,  1.6505e+06,  5.9115e+05, -3.7747e+06, -1.9869e+06,\n","        -6.0569e+06, -2.5152e+06, -2.9113e+06, -3.9348e+06,  7.3047e+06,\n","        -3.3008e+04,  8.5621e+06, -1.4189e+06,  4.1229e+06,  7.2297e+05,\n","         2.7972e+06, -2.2240e+06, -4.5786e+06, -4.9017e+05, -5.5686e+05,\n","         6.1808e+05,  4.5226e+05, -4.6576e+06,  1.5036e+06,  3.8596e+06,\n","         6.7760e+04,  2.4050e+06,  5.3973e+05,  3.3655e+06,  6.0043e+06,\n","         4.5548e+06, -2.9229e+06, -1.9764e+06,  2.0335e+06,  7.9088e+05,\n","        -3.3570e+06, -2.7523e+06,  1.5844e+06,  4.7776e+06, -6.0901e+06,\n","        -7.1306e+05, -7.0401e+06, -1.0160e+06, -8.5452e+05, -8.3591e+06,\n","        -2.4858e+06,  2.8147e+06,  5.6809e+05, -7.1948e+06, -5.9136e+05,\n","        -6.5641e+05, -1.0893e+06,  1.1050e+06, -3.7282e+06, -1.5446e+06,\n","        -5.0065e+06, -1.3416e+06, -4.9782e+06,  6.4103e+04,  1.1499e+07,\n","        -1.9864e+06,  1.5906e+06,  1.9586e+06, -1.4297e+06, -3.3825e+06,\n","        -4.2634e+06,  5.9104e+06,  2.6206e+06, -5.4291e+05,  7.6843e+05,\n","        -3.7663e+06,  4.2061e+04,  2.1857e+05, -2.0056e+06, -2.7777e+06,\n","        -1.2554e+06,  4.5516e+05,  1.2203e+06,  4.2670e+05,  5.6051e+06,\n","         7.6338e+04, -6.7945e+05, -4.5576e+06,  4.6366e+06,  4.9086e+06,\n","        -5.4790e+06, -4.7691e+05,  2.5168e+06,  1.4691e+06, -4.8765e+05,\n","        -2.1130e+06, -3.8390e+06,  1.1001e+05, -1.4188e+06, -1.1399e+07,\n","         1.8977e+06,  3.4214e+05,  2.5465e+06,  5.8003e+06, -3.4245e+06,\n","        -1.5428e+06,  2.0858e+06,  2.6819e+06,  3.9309e+06,  2.5867e+06,\n","        -5.3781e+05, -9.8270e+06,  1.3933e+06, -5.4354e+06,  6.8759e+06,\n","         4.0615e+06,  3.7278e+06,  1.1756e+06, -3.4106e+06,  7.3364e+06,\n","        -2.4015e+06,  5.4207e+06,  2.8468e+06, -1.7844e+06,  1.9116e+06,\n","         2.1905e+06,  1.3852e+06,  1.1965e+06,  7.3788e+04, -2.2959e+06,\n","         1.9097e+06, -6.6299e+06, -4.4973e+06, -8.6833e+06,  1.7420e+06,\n","        -3.6442e+05,  4.3786e+06, -6.3635e+06,  1.8350e+06,  8.0668e+04,\n","        -2.0869e+05,  5.6755e+05,  9.9864e+05,  2.8664e+06,  5.5076e+06,\n","        -1.3782e+06,  5.5430e+06, -1.0567e+06, -1.1295e+06,  8.7676e+05,\n","        -1.1291e+06,  6.4480e+06,  2.6405e+06, -4.3823e+06,  4.6510e+06,\n","         4.4668e+06, -2.7694e+06,  3.9327e+06,  4.9444e+06,  2.4008e+06,\n","         6.5223e+06,  7.2258e+05,  1.3527e+06, -2.8436e+06, -2.0618e+05,\n","         5.5572e+06,  6.6948e+06,  5.1609e+04,  3.8987e+06,  1.4908e+06,\n","        -2.3320e+06, -2.3683e+06, -6.8403e+06, -1.6892e+06,  4.8779e+06,\n","        -9.2999e+05,  8.3047e+06, -8.3664e+04, -1.7752e+06,  1.8658e+04,\n","        -1.0332e+06,  3.0586e+06, -4.4545e+06, -6.0077e+06,  2.7178e+05,\n","        -9.8234e+05, -3.0330e+06,  7.6601e+06, -6.2338e+06,  1.8040e+06,\n","         1.5381e+06, -4.5154e+06, -3.6871e+06, -2.3252e+06, -4.2004e+06,\n","        -8.2979e+06, -4.7927e+05,  2.3672e+06, -4.3703e+06, -1.7209e+06,\n","         3.4742e+05, -1.2791e+06,  1.4856e+05,  2.8044e+06,  6.1432e+05,\n","        -1.9639e+06, -1.4817e+05, -1.8928e+05,  1.2605e+06,  5.1804e+06,\n","         7.9035e+05, -4.0927e+06, -8.0338e+05,  4.0370e+06, -4.6362e+06,\n","         2.2128e+06, -1.6849e+05,  5.9439e+06, -9.1047e+05, -1.7458e+06,\n","         1.6930e+06, -1.2001e+06, -3.1195e+06,  2.7704e+06, -2.0059e+06,\n","         4.8132e+06, -4.0318e+06,  1.8322e+06, -2.2721e+06, -1.0564e+07,\n","        -4.1607e+06,  3.6040e+05,  1.8770e+06, -1.4175e+06, -1.4967e+06,\n","        -5.5719e+06, -3.0302e+06,  9.0726e+05, -9.9079e+06, -1.1045e+06,\n","        -2.9532e+05,  1.0919e+06,  2.9366e+06,  2.2177e+06,  1.7601e+06,\n","        -5.4051e+06, -2.5579e+06, -3.6964e+06,  5.0338e+06, -2.5197e+06,\n","         8.8132e+06,  5.7770e+05, -3.3767e+06,  1.3384e+06, -1.4302e+06,\n","        -1.6664e+06, -5.5678e+06, -5.8896e+05, -8.8627e+06,  7.3797e+06,\n","        -1.1653e+07, -8.5610e+05,  2.8241e+06,  1.4917e+06, -8.6499e+05,\n","        -5.3579e+06,  5.6865e+06, -7.6985e+03,  3.2437e+05,  1.4402e+06,\n","         4.4504e+06, -3.1703e+06, -1.7891e+06, -1.2417e+06, -1.3196e+05,\n","        -3.5623e+06, -4.7911e+06, -4.7995e+06, -2.3216e+06, -2.2325e+06,\n","         7.7322e+06,  5.1096e+06,  6.9489e+05,  8.7136e+06, -1.5169e+06,\n","        -9.3826e+05, -1.5991e+06,  2.8654e+06, -5.7678e+05,  4.1644e+05,\n","        -7.5016e+05,  3.0949e+06, -7.2132e+06,  1.5688e+06,  1.2097e+06,\n","         5.5259e+05,  2.8149e+06, -2.5557e+06,  2.2505e+06, -3.1889e+06,\n","        -2.6606e+06,  7.7423e+05, -2.7774e+06, -1.8941e+06, -5.9956e+06,\n","        -2.2781e+06,  2.6378e+06,  8.0330e+06, -1.1036e+06,  3.7331e+05,\n","        -1.6321e+06,  2.2843e+06,  2.4806e+06, -3.9319e+06, -3.1308e+06,\n","         7.4559e+05,  4.7402e+06, -7.6117e+05,  4.3098e+05, -9.8563e+05,\n","        -3.7858e+06,  5.3329e+06, -1.5468e+06, -4.8357e+06,  4.0773e+06,\n","        -1.0706e+06,  2.5728e+06, -1.9164e+06,  1.0869e+06,  1.9392e+06,\n","        -5.3685e+05, -2.4683e+06, -5.3379e+06, -2.2216e+06, -7.4485e+06,\n","         1.4591e+06, -4.9364e+06, -3.6545e+06,  3.2172e+06, -1.7614e+06,\n","        -3.2729e+05,  4.9712e+06,  3.1006e+06, -4.5360e+06, -4.9485e+03,\n","         3.4379e+06,  2.1566e+06, -2.0205e+06,  5.6896e+06,  1.5439e+06,\n","         1.6436e+06,  6.0742e+05,  2.7291e+06,  5.6523e+06, -2.3421e+05,\n","        -2.9770e+06, -7.7272e+06,  5.5751e+06,  4.4817e+06, -3.2462e+06,\n","        -3.7274e+06, -2.2518e+06,  2.8249e+06,  3.5981e+06, -1.0250e+07,\n","         1.7964e+05,  4.3434e+06,  3.2812e+05,  1.6392e+06,  8.4903e+05,\n","        -4.4909e+05, -2.8032e+06, -1.1477e+06,  2.6353e+06,  5.6740e+06,\n","        -9.5794e+05,  1.6627e+06, -8.4175e+06, -8.6224e+05, -3.1487e+06,\n","         3.9426e+06,  2.4780e+06,  2.5883e+06, -4.0175e+06,  9.2942e+06,\n","         1.5769e+06, -1.4755e+06, -5.9304e+06, -5.1287e+06, -1.1684e+06,\n","         3.9544e+06,  1.9348e+05,  5.7169e+06, -3.3690e+06, -1.6854e+05,\n","        -1.7876e+06,  1.4697e+06, -2.5190e+06, -2.2835e+06,  4.9349e+06,\n","         2.0607e+06,  2.9247e+06,  6.5281e+06, -1.0923e+06,  2.3517e+06,\n","         6.2459e+06,  7.7280e+06,  5.5184e+06,  2.1200e+06, -4.1107e+06,\n","         1.3448e+06,  2.8433e+06,  4.5477e+06,  1.1889e+06,  3.1953e+06]) Cost: 14339062890496.000000\n","Epoch   40/50 hypothesis: tensor([-3.7986e+08, -2.2442e+08,  5.2841e+08,  2.3428e+08, -1.8514e+08,\n","         3.3917e+07, -3.0525e+08,  6.2495e+08,  4.5894e+08, -4.4672e+08,\n","         4.6480e+08,  1.2581e+08,  2.6484e+08,  3.1060e+08,  1.8118e+08,\n","         2.7634e+08, -1.8836e+07,  1.5884e+07, -2.4329e+07,  1.9937e+08,\n","         2.1037e+08, -7.2516e+08, -7.5572e+08,  2.6181e+08,  1.1889e+09,\n","         1.4049e+08, -2.3624e+08, -8.4068e+08,  7.6193e+08, -4.8935e+08,\n","         2.9664e+08,  2.4018e+08,  2.3958e+08,  2.2310e+08,  6.4772e+08,\n","         2.6412e+08, -4.1261e+08,  5.3462e+08,  6.8100e+08,  2.4614e+08,\n","        -3.5522e+08,  5.8013e+08, -2.7304e+08, -8.3400e+08,  5.8936e+08,\n","         1.9897e+08,  6.9866e+08,  3.7554e+08, -7.7149e+08, -6.8303e+08,\n","         4.5246e+08, -4.3162e+08, -2.0094e+08, -2.3705e+07, -2.3993e+08,\n","        -5.2491e+08,  9.6898e+07,  1.1480e+08, -5.8470e+08, -3.1870e+08,\n","         2.4880e+07, -5.0109e+07, -2.7926e+08,  3.4445e+08, -4.3562e+08,\n","         2.2333e+08,  2.5068e+08, -2.4993e+08,  1.2814e+08,  8.4902e+08,\n","        -3.9190e+08,  2.5940e+08, -3.0023e+08,  1.0245e+09,  5.5726e+07,\n","         2.8290e+08,  1.1887e+09, -2.4637e+08, -6.1642e+08, -5.3268e+07,\n","         4.3843e+07, -5.8909e+07, -1.9379e+08, -4.5283e+07, -1.9062e+08,\n","         1.3898e+08, -9.6556e+08, -5.1849e+08,  1.6834e+08, -5.2196e+08,\n","         3.9710e+08,  1.9679e+08,  6.7982e+07, -4.4444e+08, -2.3411e+08,\n","        -7.1277e+08, -2.9872e+08, -3.4999e+08, -4.6350e+08,  8.6322e+08,\n","        -4.7274e+06,  1.0097e+09, -1.6945e+08,  4.8403e+08,  8.4480e+07,\n","         3.2570e+08, -2.5992e+08, -5.4255e+08, -6.1375e+07, -6.6945e+07,\n","         7.4038e+07,  5.4133e+07, -5.4632e+08,  1.7346e+08,  4.5249e+08,\n","         9.0572e+06,  2.8370e+08,  6.4219e+07,  3.9755e+08,  7.0809e+08,\n","         5.3229e+08, -3.4270e+08, -2.2952e+08,  2.3517e+08,  9.0922e+07,\n","        -3.9932e+08, -3.2439e+08,  1.8896e+08,  5.6142e+08, -7.1964e+08,\n","        -8.1946e+07, -8.3300e+08, -1.1806e+08, -9.8052e+07, -9.8953e+08,\n","        -2.9706e+08,  3.2751e+08,  6.5669e+07, -8.4743e+08, -7.0491e+07,\n","        -8.0382e+07, -1.2565e+08,  1.3091e+08, -4.4009e+08, -1.8344e+08,\n","        -5.8913e+08, -1.5924e+08, -5.8911e+08,  8.8894e+06,  1.3528e+09,\n","        -2.3296e+08,  1.9122e+08,  2.3232e+08, -1.7131e+08, -3.9945e+08,\n","        -5.0202e+08,  6.9744e+08,  3.1262e+08, -6.7797e+07,  9.2733e+07,\n","        -4.4590e+08,  2.4963e+06,  2.4446e+07, -2.3651e+08, -3.2751e+08,\n","        -1.4759e+08,  5.4018e+07,  1.4223e+08,  4.8649e+07,  6.6226e+08,\n","         1.0052e+07, -8.0494e+07, -5.3879e+08,  5.4889e+08,  5.8015e+08,\n","        -6.4332e+08, -5.8932e+07,  2.9810e+08,  1.7213e+08, -5.7513e+07,\n","        -2.4963e+08, -4.5297e+08,  1.1019e+07, -1.6802e+08, -1.3442e+09,\n","         2.2200e+08,  4.0516e+07,  2.9917e+08,  6.8360e+08, -4.0524e+08,\n","        -1.8214e+08,  2.3924e+08,  3.1879e+08,  4.6437e+08,  3.0149e+08,\n","        -6.5215e+07, -1.1631e+09,  1.6240e+08, -6.4121e+08,  8.1345e+08,\n","         4.7728e+08,  4.3932e+08,  1.3673e+08, -4.0423e+08,  8.6459e+08,\n","        -2.8427e+08,  6.3554e+08,  3.3673e+08, -2.1459e+08,  2.2319e+08,\n","         2.5854e+08,  1.6238e+08,  1.4114e+08,  1.0167e+07, -2.6779e+08,\n","         2.2590e+08, -7.8085e+08, -5.2796e+08, -1.0227e+09,  2.0572e+08,\n","        -4.0660e+07,  5.1970e+08, -7.5107e+08,  2.1525e+08,  8.9908e+06,\n","        -2.4122e+07,  6.6449e+07,  1.2069e+08,  3.3908e+08,  6.5638e+08,\n","        -1.6450e+08,  6.5430e+08, -1.2347e+08, -1.3510e+08,  1.0177e+08,\n","        -1.3419e+08,  7.6017e+08,  3.0790e+08, -5.1457e+08,  5.4941e+08,\n","         5.2600e+08, -3.2837e+08,  4.6211e+08,  5.7965e+08,  2.8354e+08,\n","         7.7250e+08,  8.6795e+07,  1.5679e+08, -3.3589e+08, -2.2608e+07,\n","         6.5453e+08,  7.8725e+08,  2.1530e+06,  4.6385e+08,  1.7863e+08,\n","        -2.7854e+08, -2.7680e+08, -8.1065e+08, -1.9680e+08,  5.7513e+08,\n","        -1.0860e+08,  9.7949e+08, -9.0783e+06, -2.0932e+08,  2.8430e+06,\n","        -1.1905e+08,  3.6412e+08, -5.2614e+08, -7.1059e+08,  3.1452e+07,\n","        -1.1151e+08, -3.5896e+08,  9.0358e+08, -7.3686e+08,  2.0980e+08,\n","         1.8165e+08, -5.3302e+08, -4.3745e+08, -2.7830e+08, -4.9851e+08,\n","        -9.7894e+08, -5.7382e+07,  2.8104e+08, -5.1462e+08, -2.0147e+08,\n","         4.0112e+07, -1.5089e+08,  1.3762e+07,  3.3134e+08,  7.3023e+07,\n","        -2.3698e+08, -2.0719e+07, -2.3317e+07,  1.5004e+08,  6.0908e+08,\n","         9.5945e+07, -4.8300e+08, -9.5173e+07,  4.7572e+08, -5.4837e+08,\n","         2.5884e+08, -2.2220e+07,  7.0503e+08, -1.0659e+08, -2.0811e+08,\n","         2.0368e+08, -1.4555e+08, -3.6411e+08,  3.2993e+08, -2.3882e+08,\n","         5.6667e+08, -4.7930e+08,  2.1297e+08, -2.7125e+08, -1.2424e+09,\n","        -4.9062e+08,  4.1867e+07,  2.2955e+08, -1.7034e+08, -1.7411e+08,\n","        -6.5658e+08, -3.5516e+08,  1.0808e+08, -1.1665e+09, -1.2672e+08,\n","        -3.3968e+07,  1.3101e+08,  3.4986e+08,  2.6337e+08,  2.0685e+08,\n","        -6.3993e+08, -3.0329e+08, -4.3183e+08,  5.9389e+08, -2.9613e+08,\n","         1.0358e+09,  6.7617e+07, -3.9845e+08,  1.6095e+08, -1.6993e+08,\n","        -1.9235e+08, -6.5517e+08, -6.7572e+07, -1.0484e+09,  8.6723e+08,\n","        -1.3715e+09, -1.0093e+08,  3.3371e+08,  1.7652e+08, -9.9543e+07,\n","        -6.3265e+08,  6.7050e+08, -3.2390e+06,  3.8870e+07,  1.6688e+08,\n","         5.2392e+08, -3.7516e+08, -2.1225e+08, -1.4627e+08, -1.7672e+07,\n","        -4.2299e+08, -5.6297e+08, -5.6629e+08, -2.7306e+08, -2.6734e+08,\n","         9.1067e+08,  6.0327e+08,  8.0056e+07,  1.0293e+09, -1.7661e+08,\n","        -1.0986e+08, -1.8804e+08,  3.3793e+08, -6.5874e+07,  5.0358e+07,\n","        -8.7465e+07,  3.6485e+08, -8.5016e+08,  1.8579e+08,  1.4235e+08,\n","         5.9776e+07,  3.3147e+08, -2.9923e+08,  2.6645e+08, -3.8009e+08,\n","        -3.1512e+08,  9.3136e+07, -3.2756e+08, -2.2607e+08, -7.0596e+08,\n","        -2.6948e+08,  3.1161e+08,  9.4378e+08, -1.3285e+08,  4.4947e+07,\n","        -1.9159e+08,  2.7271e+08,  2.9353e+08, -4.6139e+08, -3.6807e+08,\n","         8.9862e+07,  5.5976e+08, -8.9200e+07,  4.7491e+07, -1.1402e+08,\n","        -4.4490e+08,  6.2614e+08, -1.8363e+08, -5.7324e+08,  4.8202e+08,\n","        -1.2744e+08,  3.0219e+08, -2.2341e+08,  1.2928e+08,  2.2605e+08,\n","        -6.1374e+07, -2.9043e+08, -6.3053e+08, -2.6134e+08, -8.7804e+08,\n","         1.7255e+08, -5.8548e+08, -4.3196e+08,  3.7864e+08, -2.0608e+08,\n","        -4.0378e+07,  5.8244e+08,  3.6482e+08, -5.3360e+08,  4.1684e+05,\n","         4.0910e+08,  2.5705e+08, -2.4211e+08,  6.7079e+08,  1.8283e+08,\n","         1.8837e+08,  7.4273e+07,  3.1983e+08,  6.6803e+08, -2.5751e+07,\n","        -3.5163e+08, -9.1438e+08,  6.5803e+08,  5.2719e+08, -3.8709e+08,\n","        -4.3688e+08, -2.6435e+08,  3.3169e+08,  4.2548e+08, -1.2106e+09,\n","         2.0381e+07,  5.1052e+08,  3.9075e+07,  1.9423e+08,  1.0148e+08,\n","        -5.3950e+07, -3.3230e+08, -1.3116e+08,  3.1148e+08,  6.7021e+08,\n","        -1.1744e+08,  1.9367e+08, -9.9077e+08, -1.0405e+08, -3.7270e+08,\n","         4.6340e+08,  2.9271e+08,  3.0634e+08, -4.7599e+08,  1.0935e+09,\n","         1.8436e+08, -1.7371e+08, -7.0001e+08, -6.0405e+08, -1.3326e+08,\n","         4.6488e+08,  2.2474e+07,  6.7419e+08, -3.9689e+08, -1.6363e+07,\n","        -2.1614e+08,  1.7804e+08, -2.9383e+08, -2.6985e+08,  5.8453e+08,\n","         2.4961e+08,  3.4541e+08,  7.7283e+08, -1.3041e+08,  2.7854e+08,\n","         7.3780e+08,  9.0783e+08,  6.5152e+08,  2.4927e+08, -4.8236e+08,\n","         1.5503e+08,  3.3861e+08,  5.3772e+08,  1.4146e+08,  3.7397e+08]) Cost: 199511418561626112.000000\n","Epoch   50/50 hypothesis: tensor([-4.4778e+10, -2.6466e+10,  6.2382e+10,  2.7637e+10, -2.1872e+10,\n","         3.9692e+09, -3.5914e+10,  7.3703e+10,  5.4197e+10, -5.2686e+10,\n","         5.4817e+10,  1.4831e+10,  3.1212e+10,  3.6666e+10,  2.1376e+10,\n","         3.2550e+10, -2.2789e+09,  1.8969e+09, -2.8208e+09,  2.3452e+10,\n","         2.4822e+10, -8.5543e+10, -8.9192e+10,  3.0895e+10,  1.4025e+11,\n","         1.6618e+10, -2.7746e+10, -9.9127e+10,  8.9884e+10, -5.7762e+10,\n","         3.4987e+10,  2.8364e+10,  2.8224e+10,  2.6323e+10,  7.6464e+10,\n","         3.1119e+10, -4.8655e+10,  6.3090e+10,  8.0345e+10,  2.9091e+10,\n","        -4.1870e+10,  6.8464e+10, -3.2128e+10, -9.8364e+10,  6.9580e+10,\n","         2.3482e+10,  8.2451e+10,  4.4308e+10, -9.1019e+10, -8.0540e+10,\n","         5.3371e+10, -5.0923e+10, -2.3667e+10, -2.8595e+09, -2.8298e+10,\n","        -6.1886e+10,  1.1407e+10,  1.3551e+10, -6.8980e+10, -3.7654e+10,\n","         2.9358e+09, -5.8871e+09, -3.3011e+10,  4.0701e+10, -5.1396e+10,\n","         2.6317e+10,  2.9561e+10, -2.9475e+10,  1.5140e+10,  1.0018e+11,\n","        -4.6222e+10,  3.0523e+10, -3.5413e+10,  1.2083e+11,  6.5342e+09,\n","         3.3350e+10,  1.4022e+11, -2.9081e+10, -7.2689e+10, -6.2535e+09,\n","         5.2103e+09, -7.0172e+09, -2.2833e+10, -5.3512e+09, -2.2549e+10,\n","         1.6319e+10, -1.1385e+11, -6.1179e+10,  1.9828e+10, -6.1507e+10,\n","         4.6825e+10,  2.3248e+10,  7.9909e+09, -5.2412e+10, -2.7611e+10,\n","        -8.4049e+10, -3.5270e+10, -4.1394e+10, -5.4663e+10,  1.0185e+11,\n","        -5.7151e+08,  1.1910e+11, -2.0023e+10,  5.7058e+10,  9.9524e+09,\n","         3.8348e+10, -3.0620e+10, -6.4040e+10, -7.2990e+09, -7.9177e+09,\n","         8.7523e+09,  6.3986e+09, -6.4393e+10,  2.0397e+10,  5.3328e+10,\n","         1.0859e+09,  3.3465e+10,  7.5844e+09,  4.6904e+10,  8.3521e+10,\n","         6.2706e+10, -4.0391e+10, -2.7014e+10,  2.7662e+10,  1.0686e+10,\n","        -4.7159e+10, -3.8259e+10,  2.2324e+10,  6.6189e+10, -8.4909e+10,\n","        -9.6296e+09, -9.8303e+10, -1.3897e+10, -1.1521e+10, -1.1678e+11,\n","        -3.5107e+10,  3.8557e+10,  7.7242e+09, -9.9940e+10, -8.3277e+09,\n","        -9.5305e+09, -1.4774e+10,  1.5452e+10, -5.1918e+10, -2.1659e+10,\n","        -6.9469e+10, -1.8801e+10, -6.9522e+10,  1.0702e+09,  1.5951e+11,\n","        -2.7458e+10,  2.2616e+10,  2.7425e+10, -2.0252e+10, -4.7126e+10,\n","        -5.9204e+10,  8.2275e+10,  3.6935e+10, -8.0593e+09,  1.0974e+10,\n","        -5.2625e+10,  2.5266e+08,  2.8614e+09, -2.7897e+10, -3.8630e+10,\n","        -1.7401e+10,  6.3775e+09,  1.6748e+10,  5.7105e+09,  7.8139e+10,\n","         1.2031e+09, -9.5005e+09, -6.3575e+10,  6.4780e+10,  6.8452e+10,\n","        -7.5836e+10, -6.9959e+09,  3.5183e+10,  2.0286e+10, -6.7846e+09,\n","        -2.9452e+10, -5.3434e+10,  1.2672e+09, -1.9830e+10, -1.5855e+11,\n","         2.6156e+10,  4.7814e+09,  3.5270e+10,  8.0627e+10, -4.7824e+10,\n","        -2.1488e+10,  2.8107e+10,  3.7646e+10,  5.4789e+10,  3.5504e+10,\n","        -7.7221e+09, -1.3727e+11,  1.9123e+10, -7.5637e+10,  9.5993e+10,\n","         5.6269e+10,  5.1815e+10,  1.6097e+10, -4.7715e+10,  1.0197e+11,\n","        -3.3549e+10,  7.4903e+10,  3.9736e+10, -2.5381e+10,  2.6289e+10,\n","         3.0500e+10,  1.9137e+10,  1.6649e+10,  1.2235e+09, -3.1538e+10,\n","         2.6658e+10, -9.2088e+10, -6.2236e+10, -1.2061e+11,  2.4271e+10,\n","        -4.7576e+09,  6.1357e+10, -8.8602e+10,  2.5370e+10,  1.0516e+09,\n","        -2.8367e+09,  7.8306e+09,  1.4286e+10,  4.0013e+10,  7.7538e+10,\n","        -1.9435e+10,  7.7188e+10, -1.4545e+10, -1.5967e+10,  1.1978e+10,\n","        -1.5845e+10,  8.9662e+10,  3.6261e+10, -6.0659e+10,  6.4820e+10,\n","         6.2032e+10, -3.8763e+10,  5.4480e+10,  6.8316e+10,  3.3450e+10,\n","         9.1175e+10,  1.0264e+10,  1.8448e+10, -3.9628e+10, -2.6384e+09,\n","         7.7190e+10,  9.2822e+10,  1.8839e+08,  5.4781e+10,  2.1117e+10,\n","        -3.2914e+10, -3.2608e+10, -9.5687e+10, -2.3173e+10,  6.7838e+10,\n","        -1.2793e+10,  1.1554e+11, -1.0583e+09, -2.4690e+10,  3.4576e+08,\n","        -1.3996e+10,  4.3006e+10, -6.2075e+10, -8.3853e+10,  3.7001e+09,\n","        -1.3081e+10, -4.2363e+10,  1.0659e+11, -8.6945e+10,  2.4698e+10,\n","         2.1431e+10, -6.2880e+10, -5.1643e+10, -3.2896e+10, -5.8854e+10,\n","        -1.1548e+11, -6.7828e+09,  3.3182e+10, -6.0689e+10, -2.3739e+10,\n","         4.7169e+09, -1.7798e+10,  1.5609e+09,  3.9094e+10,  8.6228e+09,\n","        -2.8042e+10, -2.4982e+09, -2.7660e+09,  1.7720e+10,  7.1813e+10,\n","         1.1363e+10, -5.6978e+10, -1.1233e+10,  5.6107e+10, -6.4710e+10,\n","         3.0495e+10, -2.6602e+09,  8.3229e+10, -1.2561e+10, -2.4584e+10,\n","         2.4092e+10, -1.7235e+10, -4.2886e+10,  3.8970e+10, -2.8209e+10,\n","         6.6827e+10, -5.6600e+10,  2.5069e+10, -3.2050e+10, -1.4649e+11,\n","        -5.7870e+10,  4.9286e+09,  2.7213e+10, -2.0145e+10, -2.0497e+10,\n","        -7.7439e+10, -4.1856e+10,  1.2767e+10, -1.3757e+11, -1.4888e+10,\n","        -3.9921e+09,  1.5491e+10,  4.1326e+10,  3.1097e+10,  2.4387e+10,\n","        -7.5526e+10, -3.5801e+10, -5.0868e+10,  7.0056e+10, -3.4913e+10,\n","         1.2212e+11,  7.9670e+09, -4.7004e+10,  1.9037e+10, -2.0065e+10,\n","        -2.2619e+10, -7.7257e+10, -7.9391e+09, -1.2372e+11,  1.0224e+11,\n","        -1.6173e+11, -1.1905e+10,  3.9373e+10,  2.0832e+10, -1.1700e+10,\n","        -7.4638e+10,  7.9087e+10, -4.2097e+08,  4.5949e+09,  1.9635e+10,\n","         6.1784e+10, -4.4275e+10, -2.5057e+10, -1.7251e+10, -2.1193e+09,\n","        -4.9941e+10, -6.6371e+10, -6.6801e+10, -3.2197e+10, -3.1601e+10,\n","         1.0740e+11,  7.1171e+10,  9.4117e+09,  1.2144e+11, -2.0794e+10,\n","        -1.2945e+10, -2.2171e+10,  3.9861e+10, -7.7349e+09,  5.9613e+09,\n","        -1.0300e+10,  4.3034e+10, -1.0027e+11,  2.1928e+10,  1.6785e+10,\n","         6.9620e+09,  3.9090e+10, -3.5259e+10,  3.1447e+10, -4.4901e+10,\n","        -3.7192e+10,  1.1017e+10, -3.8638e+10, -2.6711e+10, -8.3252e+10,\n","        -3.1800e+10,  3.6765e+10,  1.1126e+11, -1.5715e+10,  5.3168e+09,\n","        -2.2585e+10,  3.2222e+10,  3.4640e+10, -5.4384e+10, -4.3397e+10,\n","         1.0632e+10,  6.6040e+10, -1.0512e+10,  5.5465e+09, -1.3412e+10,\n","        -5.2452e+10,  7.3810e+10, -2.1680e+10, -6.7666e+10,  5.6876e+10,\n","        -1.5051e+10,  3.5624e+10, -2.6309e+10,  1.5267e+10,  2.6620e+10,\n","        -7.2067e+09, -3.4247e+10, -7.4392e+10, -3.0816e+10, -1.0356e+11,\n","         2.0361e+10, -6.9116e+10, -5.0968e+10,  4.4649e+10, -2.4281e+10,\n","        -4.7918e+09,  6.8638e+10,  4.3019e+10, -6.2919e+10,  6.5455e+07,\n","         4.8317e+10,  3.0366e+10, -2.8622e+10,  7.9120e+10,  2.1579e+10,\n","         2.2129e+10,  8.8044e+09,  3.7692e+10,  7.8821e+10, -3.0063e+09,\n","        -4.1485e+10, -1.0791e+11,  7.7627e+10,  6.2162e+10, -4.5731e+10,\n","        -5.1487e+10, -3.1161e+10,  3.9101e+10,  5.0207e+10, -1.4283e+11,\n","         2.3909e+09,  6.0190e+10,  4.6152e+09,  2.2926e+10,  1.1993e+10,\n","        -6.3798e+09, -3.9226e+10, -1.5402e+10,  3.6752e+10,  7.9072e+10,\n","        -1.3927e+10,  2.2806e+10, -1.1683e+11, -1.2312e+10, -4.3985e+10,\n","         5.4635e+10,  3.4534e+10,  3.6153e+10, -5.6182e+10,  1.2894e+11,\n","         2.1720e+10, -2.0486e+10, -8.2580e+10, -7.1238e+10, -1.5644e+10,\n","         5.4811e+10,  2.6456e+09,  7.9524e+10, -4.6807e+10, -1.8720e+09,\n","        -2.5583e+10,  2.1079e+10, -3.4605e+10, -3.1840e+10,  6.8990e+10,\n","         2.9552e+10,  4.0751e+10,  9.1208e+10, -1.5409e+10,  3.2875e+10,\n","         8.7048e+10,  1.0703e+11,  7.6862e+10,  2.9391e+10, -5.6857e+10,\n","         1.8227e+10,  3.9995e+10,  6.3451e+10,  1.6707e+10,  4.4064e+10]) Cost: 2776074542356562444288.000000\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"n24-nK6dGl5f","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1599877054121,"user_tz":-540,"elapsed":851,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"40aeec0f-a7de-4318-f90a-d751a65edbcb"},"source":["10%3"],"execution_count":24,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1"]},"metadata":{"tags":[]},"execution_count":24}]},{"cell_type":"code","metadata":{"id":"wEEMDjTVFhKW","colab_type":"code","colab":{}},"source":[""],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"6rF_YJh3JRq-","colab_type":"text"},"source":["#### Multivariate Linear Regression : Using Package"]},{"cell_type":"code","metadata":{"id":"7U8HYq8pJWKj","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599877793378,"user_tz":-540,"elapsed":928,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F"],"execution_count":49,"outputs":[]},{"cell_type":"code","metadata":{"id":"kp5A-vi8JcKc","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599877856478,"user_tz":-540,"elapsed":925,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["torch.manual_seed(0)\n","x_train=100*torch.randn((500,10))\n","y_train=100*torch.randn((500,1))"],"execution_count":52,"outputs":[]},{"cell_type":"code","metadata":{"id":"IPkRjVt2Ji4E","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599877913732,"user_tz":-540,"elapsed":796,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["model= nn.Linear(x_train.shape[1],1)"],"execution_count":54,"outputs":[]},{"cell_type":"code","metadata":{"id":"El-hqCXVJ01t","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":87},"executionInfo":{"status":"ok","timestamp":1599877943506,"user_tz":-540,"elapsed":817,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"295a66ae-1f5a-44bb-e49c-67cb7ed3be24"},"source":["print(list(model.parameters()))"],"execution_count":55,"outputs":[{"output_type":"stream","text":["[Parameter containing:\n","tensor([[-0.3017,  0.1973,  0.1028, -0.0898,  0.1026,  0.2678,  0.2326,  0.1918,\n","         -0.1841,  0.0909]], requires_grad=True), Parameter containing:\n","tensor([0.2373], requires_grad=True)]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"OMRecMm3KA11","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599877967608,"user_tz":-540,"elapsed":806,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["optimizer = torch.optim.SGD(model.parameters(), lr=1e-5) "],"execution_count":56,"outputs":[]},{"cell_type":"code","metadata":{"id":"8XfM2KEdKGut","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1599878055455,"user_tz":-540,"elapsed":4670,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"54b8ce3b-a574-42b1-b696-d8df0818f4dd"},"source":["nb_epochs = 20000\n","for epoch in range(nb_epochs+1):\n","\n","    # H(x) 계산\n","    prediction = model(x_train)\n","    # model(x_train)은 model.forward(x_train)와 동일함.\n","\n","    # cost 계산\n","    cost = F.mse_loss(prediction, y_train) # <== 파이토치에서 제공하는 평균 제곱 오차 함수\n","\n","    # cost로 H(x) 개선하는 부분\n","    # gradient를 0으로 초기화\n","    optimizer.zero_grad()\n","    # 비용 함수를 미분하여 gradient 계산\n","    cost.backward()\n","    # W와 b를 업데이트\n","    optimizer.step()\n","\n","    if epoch % 100 == 0:\n","    # 100번마다 로그 출력\n","      print('Epoch {:4d}/{} Cost: {:.6f}'.format(\n","          epoch, nb_epochs, cost.item()\n","      ))"],"execution_count":58,"outputs":[{"output_type":"stream","text":["Epoch    0/20000 Cost: 8710.957031\n","Epoch  100/20000 Cost: 8710.931641\n","Epoch  200/20000 Cost: 8710.907227\n","Epoch  300/20000 Cost: 8710.880859\n","Epoch  400/20000 Cost: 8710.855469\n","Epoch  500/20000 Cost: 8710.829102\n","Epoch  600/20000 Cost: 8710.801758\n","Epoch  700/20000 Cost: 8710.777344\n","Epoch  800/20000 Cost: 8710.750977\n","Epoch  900/20000 Cost: 8710.725586\n","Epoch 1000/20000 Cost: 8710.704102\n","Epoch 1100/20000 Cost: 8710.677734\n","Epoch 1200/20000 Cost: 8710.650391\n","Epoch 1300/20000 Cost: 8710.625977\n","Epoch 1400/20000 Cost: 8710.601562\n","Epoch 1500/20000 Cost: 8710.579102\n","Epoch 1600/20000 Cost: 8710.549805\n","Epoch 1700/20000 Cost: 8710.528320\n","Epoch 1800/20000 Cost: 8710.500977\n","Epoch 1900/20000 Cost: 8710.480469\n","Epoch 2000/20000 Cost: 8710.457031\n","Epoch 2100/20000 Cost: 8710.430664\n","Epoch 2200/20000 Cost: 8710.404297\n","Epoch 2300/20000 Cost: 8710.377930\n","Epoch 2400/20000 Cost: 8710.356445\n","Epoch 2500/20000 Cost: 8710.335938\n","Epoch 2600/20000 Cost: 8710.309570\n","Epoch 2700/20000 Cost: 8710.289062\n","Epoch 2800/20000 Cost: 8710.260742\n","Epoch 2900/20000 Cost: 8710.238281\n","Epoch 3000/20000 Cost: 8710.218750\n","Epoch 3100/20000 Cost: 8710.193359\n","Epoch 3200/20000 Cost: 8710.171875\n","Epoch 3300/20000 Cost: 8710.146484\n","Epoch 3400/20000 Cost: 8710.125000\n","Epoch 3500/20000 Cost: 8710.102539\n","Epoch 3600/20000 Cost: 8710.077148\n","Epoch 3700/20000 Cost: 8710.055664\n","Epoch 3800/20000 Cost: 8710.033203\n","Epoch 3900/20000 Cost: 8710.007812\n","Epoch 4000/20000 Cost: 8709.987305\n","Epoch 4100/20000 Cost: 8709.965820\n","Epoch 4200/20000 Cost: 8709.945312\n","Epoch 4300/20000 Cost: 8709.919922\n","Epoch 4400/20000 Cost: 8709.899414\n","Epoch 4500/20000 Cost: 8709.877930\n","Epoch 4600/20000 Cost: 8709.852539\n","Epoch 4700/20000 Cost: 8709.833008\n","Epoch 4800/20000 Cost: 8709.809570\n","Epoch 4900/20000 Cost: 8709.790039\n","Epoch 5000/20000 Cost: 8709.771484\n","Epoch 5100/20000 Cost: 8709.747070\n","Epoch 5200/20000 Cost: 8709.723633\n","Epoch 5300/20000 Cost: 8709.700195\n","Epoch 5400/20000 Cost: 8709.682617\n","Epoch 5500/20000 Cost: 8709.663086\n","Epoch 5600/20000 Cost: 8709.638672\n","Epoch 5700/20000 Cost: 8709.619141\n","Epoch 5800/20000 Cost: 8709.599609\n","Epoch 5900/20000 Cost: 8709.578125\n","Epoch 6000/20000 Cost: 8709.555664\n","Epoch 6100/20000 Cost: 8709.536133\n","Epoch 6200/20000 Cost: 8709.511719\n","Epoch 6300/20000 Cost: 8709.496094\n","Epoch 6400/20000 Cost: 8709.474609\n","Epoch 6500/20000 Cost: 8709.455078\n","Epoch 6600/20000 Cost: 8709.432617\n","Epoch 6700/20000 Cost: 8709.414062\n","Epoch 6800/20000 Cost: 8709.392578\n","Epoch 6900/20000 Cost: 8709.373047\n","Epoch 7000/20000 Cost: 8709.351562\n","Epoch 7100/20000 Cost: 8709.333984\n","Epoch 7200/20000 Cost: 8709.310547\n","Epoch 7300/20000 Cost: 8709.291992\n","Epoch 7400/20000 Cost: 8709.273438\n","Epoch 7500/20000 Cost: 8709.253906\n","Epoch 7600/20000 Cost: 8709.234375\n","Epoch 7700/20000 Cost: 8709.216797\n","Epoch 7800/20000 Cost: 8709.197266\n","Epoch 7900/20000 Cost: 8709.175781\n","Epoch 8000/20000 Cost: 8709.157227\n","Epoch 8100/20000 Cost: 8709.137695\n","Epoch 8200/20000 Cost: 8709.119141\n","Epoch 8300/20000 Cost: 8709.098633\n","Epoch 8400/20000 Cost: 8709.080078\n","Epoch 8500/20000 Cost: 8709.064453\n","Epoch 8600/20000 Cost: 8709.041992\n","Epoch 8700/20000 Cost: 8709.022461\n","Epoch 8800/20000 Cost: 8709.004883\n","Epoch 8900/20000 Cost: 8708.988281\n","Epoch 9000/20000 Cost: 8708.966797\n","Epoch 9100/20000 Cost: 8708.950195\n","Epoch 9200/20000 Cost: 8708.933594\n","Epoch 9300/20000 Cost: 8708.914062\n","Epoch 9400/20000 Cost: 8708.893555\n","Epoch 9500/20000 Cost: 8708.876953\n","Epoch 9600/20000 Cost: 8708.861328\n","Epoch 9700/20000 Cost: 8708.838867\n","Epoch 9800/20000 Cost: 8708.822266\n","Epoch 9900/20000 Cost: 8708.804688\n","Epoch 10000/20000 Cost: 8708.788086\n","Epoch 10100/20000 Cost: 8708.768555\n","Epoch 10200/20000 Cost: 8708.751953\n","Epoch 10300/20000 Cost: 8708.737305\n","Epoch 10400/20000 Cost: 8708.714844\n","Epoch 10500/20000 Cost: 8708.699219\n","Epoch 10600/20000 Cost: 8708.682617\n","Epoch 10700/20000 Cost: 8708.663086\n","Epoch 10800/20000 Cost: 8708.647461\n","Epoch 10900/20000 Cost: 8708.628906\n","Epoch 11000/20000 Cost: 8708.611328\n","Epoch 11100/20000 Cost: 8708.594727\n","Epoch 11200/20000 Cost: 8708.578125\n","Epoch 11300/20000 Cost: 8708.558594\n","Epoch 11400/20000 Cost: 8708.544922\n","Epoch 11500/20000 Cost: 8708.531250\n","Epoch 11600/20000 Cost: 8708.509766\n","Epoch 11700/20000 Cost: 8708.494141\n","Epoch 11800/20000 Cost: 8708.477539\n","Epoch 11900/20000 Cost: 8708.460938\n","Epoch 12000/20000 Cost: 8708.445312\n","Epoch 12100/20000 Cost: 8708.425781\n","Epoch 12200/20000 Cost: 8708.412109\n","Epoch 12300/20000 Cost: 8708.393555\n","Epoch 12400/20000 Cost: 8708.379883\n","Epoch 12500/20000 Cost: 8708.364258\n","Epoch 12600/20000 Cost: 8708.348633\n","Epoch 12700/20000 Cost: 8708.332031\n","Epoch 12800/20000 Cost: 8708.316406\n","Epoch 12900/20000 Cost: 8708.299805\n","Epoch 13000/20000 Cost: 8708.285156\n","Epoch 13100/20000 Cost: 8708.266602\n","Epoch 13200/20000 Cost: 8708.252930\n","Epoch 13300/20000 Cost: 8708.236328\n","Epoch 13400/20000 Cost: 8708.220703\n","Epoch 13500/20000 Cost: 8708.208008\n","Epoch 13600/20000 Cost: 8708.192383\n","Epoch 13700/20000 Cost: 8708.175781\n","Epoch 13800/20000 Cost: 8708.159180\n","Epoch 13900/20000 Cost: 8708.143555\n","Epoch 14000/20000 Cost: 8708.128906\n","Epoch 14100/20000 Cost: 8708.112305\n","Epoch 14200/20000 Cost: 8708.099609\n","Epoch 14300/20000 Cost: 8708.083008\n","Epoch 14400/20000 Cost: 8708.066406\n","Epoch 14500/20000 Cost: 8708.052734\n","Epoch 14600/20000 Cost: 8708.038086\n","Epoch 14700/20000 Cost: 8708.025391\n","Epoch 14800/20000 Cost: 8708.010742\n","Epoch 14900/20000 Cost: 8707.995117\n","Epoch 15000/20000 Cost: 8707.981445\n","Epoch 15100/20000 Cost: 8707.965820\n","Epoch 15200/20000 Cost: 8707.952148\n","Epoch 15300/20000 Cost: 8707.935547\n","Epoch 15400/20000 Cost: 8707.923828\n","Epoch 15500/20000 Cost: 8707.906250\n","Epoch 15600/20000 Cost: 8707.892578\n","Epoch 15700/20000 Cost: 8707.879883\n","Epoch 15800/20000 Cost: 8707.865234\n","Epoch 15900/20000 Cost: 8707.849609\n","Epoch 16000/20000 Cost: 8707.837891\n","Epoch 16100/20000 Cost: 8707.821289\n","Epoch 16200/20000 Cost: 8707.807617\n","Epoch 16300/20000 Cost: 8707.796875\n","Epoch 16400/20000 Cost: 8707.780273\n","Epoch 16500/20000 Cost: 8707.765625\n","Epoch 16600/20000 Cost: 8707.754883\n","Epoch 16700/20000 Cost: 8707.740234\n","Epoch 16800/20000 Cost: 8707.723633\n","Epoch 16900/20000 Cost: 8707.709961\n","Epoch 17000/20000 Cost: 8707.698242\n","Epoch 17100/20000 Cost: 8707.681641\n","Epoch 17200/20000 Cost: 8707.668945\n","Epoch 17300/20000 Cost: 8707.656250\n","Epoch 17400/20000 Cost: 8707.640625\n","Epoch 17500/20000 Cost: 8707.631836\n","Epoch 17600/20000 Cost: 8707.620117\n","Epoch 17700/20000 Cost: 8707.603516\n","Epoch 17800/20000 Cost: 8707.590820\n","Epoch 17900/20000 Cost: 8707.578125\n","Epoch 18000/20000 Cost: 8707.568359\n","Epoch 18100/20000 Cost: 8707.553711\n","Epoch 18200/20000 Cost: 8707.537109\n","Epoch 18300/20000 Cost: 8707.526367\n","Epoch 18400/20000 Cost: 8707.513672\n","Epoch 18500/20000 Cost: 8707.500977\n","Epoch 18600/20000 Cost: 8707.487305\n","Epoch 18700/20000 Cost: 8707.473633\n","Epoch 18800/20000 Cost: 8707.462891\n","Epoch 18900/20000 Cost: 8707.451172\n","Epoch 19000/20000 Cost: 8707.435547\n","Epoch 19100/20000 Cost: 8707.424805\n","Epoch 19200/20000 Cost: 8707.411133\n","Epoch 19300/20000 Cost: 8707.401367\n","Epoch 19400/20000 Cost: 8707.389648\n","Epoch 19500/20000 Cost: 8707.373047\n","Epoch 19600/20000 Cost: 8707.364258\n","Epoch 19700/20000 Cost: 8707.348633\n","Epoch 19800/20000 Cost: 8707.338867\n","Epoch 19900/20000 Cost: 8707.327148\n","Epoch 20000/20000 Cost: 8707.314453\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"6MOD2_h_KhY7","colab_type":"text"},"source":["완전 발산함 ㄷㄷ"]},{"cell_type":"markdown","metadata":{"id":"NnDDkABVshms","colab_type":"text"},"source":["#### 미니배치와 데이터로드"]},{"cell_type":"code","metadata":{"id":"jE7-9BHpKTpU","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599890857946,"user_tz":-540,"elapsed":3541,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F"],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"id":"JkQitA6r7RG0","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599890864278,"user_tz":-540,"elapsed":850,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["from torch.utils.data import TensorDataset # 텐서데이터셋\n","from torch.utils.data import DataLoader # 데이터로더"],"execution_count":2,"outputs":[]},{"cell_type":"code","metadata":{"id":"gkep_Ggo7TUP","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599890874068,"user_tz":-540,"elapsed":861,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["x_train  =  torch.FloatTensor([[73,  80,  75], \n","                               [93,  88,  93], \n","                               [89,  91,  90], \n","                               [96,  98,  100],   \n","                               [73,  66,  70]])  \n","y_train  =  torch.FloatTensor([[152],  [185],  [180],  [196],  [142]])"],"execution_count":3,"outputs":[]},{"cell_type":"code","metadata":{"id":"r6yX4HqN7VtO","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":175},"executionInfo":{"status":"ok","timestamp":1599890909794,"user_tz":-540,"elapsed":813,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"d5a09e10-a7c2-4b0a-c6d0-ee6f38815a14"},"source":["dataset = TensorDataset(x_train, y_train)\n","print(dataset.tensors)"],"execution_count":6,"outputs":[{"output_type":"stream","text":["(tensor([[ 73.,  80.,  75.],\n","        [ 93.,  88.,  93.],\n","        [ 89.,  91.,  90.],\n","        [ 96.,  98., 100.],\n","        [ 73.,  66.,  70.]]), tensor([[152.],\n","        [185.],\n","        [180.],\n","        [196.],\n","        [142.]]))\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"cDDwvliD7YPu","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1599891208694,"user_tz":-540,"elapsed":878,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"0ab8d658-4617-4cf4-f022-2bd618c0b822"},"source":["dataloader = DataLoader(dataset, batch_size=2, shuffle=True)"],"execution_count":12,"outputs":[{"output_type":"stream","text":["2\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"MdUXmQxy72a_","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599891083783,"user_tz":-540,"elapsed":804,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["model = nn.Linear(x_train.shape[1],1) #W의 모양을 따라간다고 생각하면 됨\n","optimizer = torch.optim.SGD(model.parameters(), lr=1e-5) "],"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"id":"d89hzMAd8I64","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1599891331677,"user_tz":-540,"elapsed":1136,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"eb25a1c2-5ba2-4180-b692-143f06ca141c"},"source":["nb_epochs = 20\n","for epoch in range(nb_epochs + 1):\n","  for batch_idx, samples in enumerate(dataloader):\n","    #print(batch_idx)\n","    #print(samples)\n","    x_train, y_train = samples\n","    # H(x) 계산\n","    prediction = model(x_train)\n","\n","    # cost 계산\n","    cost = F.mse_loss(prediction, y_train)\n","\n","    # cost로 H(x) 계산\n","    optimizer.zero_grad()\n","    cost.backward()\n","    optimizer.step()\n","\n","    print('Epoch {:4d}/{} Batch {}/{} Cost: {:.6f}'.format(\n","        epoch, nb_epochs, batch_idx+1, len(dataloader),\n","        cost.item()\n","        ))\n","  print('-------------------------------------------------------')"],"execution_count":16,"outputs":[{"output_type":"stream","text":["Epoch    0/20 Batch 1/3 Cost: 11.236538\n","Epoch    0/20 Batch 2/3 Cost: 11.624362\n","Epoch    0/20 Batch 3/3 Cost: 15.153828\n","-------------------------------------------------------\n","Epoch    1/20 Batch 1/3 Cost: 0.145667\n","Epoch    1/20 Batch 2/3 Cost: 18.506157\n","Epoch    1/20 Batch 3/3 Cost: 18.416874\n","-------------------------------------------------------\n","Epoch    2/20 Batch 1/3 Cost: 8.622171\n","Epoch    2/20 Batch 2/3 Cost: 12.490889\n","Epoch    2/20 Batch 3/3 Cost: 20.303455\n","-------------------------------------------------------\n","Epoch    3/20 Batch 1/3 Cost: 6.579765\n","Epoch    3/20 Batch 2/3 Cost: 19.629238\n","Epoch    3/20 Batch 3/3 Cost: 15.816690\n","-------------------------------------------------------\n","Epoch    4/20 Batch 1/3 Cost: 14.574165\n","Epoch    4/20 Batch 2/3 Cost: 7.833930\n","Epoch    4/20 Batch 3/3 Cost: 14.812562\n","-------------------------------------------------------\n","Epoch    5/20 Batch 1/3 Cost: 3.290776\n","Epoch    5/20 Batch 2/3 Cost: 32.140411\n","Epoch    5/20 Batch 3/3 Cost: 4.002991\n","-------------------------------------------------------\n","Epoch    6/20 Batch 1/3 Cost: 16.863111\n","Epoch    6/20 Batch 2/3 Cost: 7.920909\n","Epoch    6/20 Batch 3/3 Cost: 2.983284\n","-------------------------------------------------------\n","Epoch    7/20 Batch 1/3 Cost: 12.872454\n","Epoch    7/20 Batch 2/3 Cost: 1.819086\n","Epoch    7/20 Batch 3/3 Cost: 26.982235\n","-------------------------------------------------------\n","Epoch    8/20 Batch 1/3 Cost: 10.712128\n","Epoch    8/20 Batch 2/3 Cost: 12.679688\n","Epoch    8/20 Batch 3/3 Cost: 4.778683\n","-------------------------------------------------------\n","Epoch    9/20 Batch 1/3 Cost: 5.972280\n","Epoch    9/20 Batch 2/3 Cost: 11.831340\n","Epoch    9/20 Batch 3/3 Cost: 21.326452\n","-------------------------------------------------------\n","Epoch   10/20 Batch 1/3 Cost: 10.148180\n","Epoch   10/20 Batch 2/3 Cost: 15.897996\n","Epoch   10/20 Batch 3/3 Cost: 14.409540\n","-------------------------------------------------------\n","Epoch   11/20 Batch 1/3 Cost: 9.960628\n","Epoch   11/20 Batch 2/3 Cost: 16.517170\n","Epoch   11/20 Batch 3/3 Cost: 24.237171\n","-------------------------------------------------------\n","Epoch   12/20 Batch 1/3 Cost: 11.861384\n","Epoch   12/20 Batch 2/3 Cost: 9.070305\n","Epoch   12/20 Batch 3/3 Cost: 19.731512\n","-------------------------------------------------------\n","Epoch   13/20 Batch 1/3 Cost: 9.907498\n","Epoch   13/20 Batch 2/3 Cost: 12.683174\n","Epoch   13/20 Batch 3/3 Cost: 6.418819\n","-------------------------------------------------------\n","Epoch   14/20 Batch 1/3 Cost: 7.926448\n","Epoch   14/20 Batch 2/3 Cost: 16.132605\n","Epoch   14/20 Batch 3/3 Cost: 4.207331\n","-------------------------------------------------------\n","Epoch   15/20 Batch 1/3 Cost: 16.848574\n","Epoch   15/20 Batch 2/3 Cost: 1.465322\n","Epoch   15/20 Batch 3/3 Cost: 19.298094\n","-------------------------------------------------------\n","Epoch   16/20 Batch 1/3 Cost: 13.958281\n","Epoch   16/20 Batch 2/3 Cost: 8.317746\n","Epoch   16/20 Batch 3/3 Cost: 18.580551\n","-------------------------------------------------------\n","Epoch   17/20 Batch 1/3 Cost: 10.313631\n","Epoch   17/20 Batch 2/3 Cost: 13.235029\n","Epoch   17/20 Batch 3/3 Cost: 7.470466\n","-------------------------------------------------------\n","Epoch   18/20 Batch 1/3 Cost: 6.189227\n","Epoch   18/20 Batch 2/3 Cost: 11.417236\n","Epoch   18/20 Batch 3/3 Cost: 20.864330\n","-------------------------------------------------------\n","Epoch   19/20 Batch 1/3 Cost: 16.496956\n","Epoch   19/20 Batch 2/3 Cost: 11.883080\n","Epoch   19/20 Batch 3/3 Cost: 9.840249\n","-------------------------------------------------------\n","Epoch   20/20 Batch 1/3 Cost: 10.968362\n","Epoch   20/20 Batch 2/3 Cost: 13.209673\n","Epoch   20/20 Batch 3/3 Cost: 6.089755\n","-------------------------------------------------------\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"smTBrQ5z8vBm","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1599891382772,"user_tz":-540,"elapsed":911,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"7719767f-59b9-4071-9bb0-6ceade29c7d7"},"source":["# 임의의 입력 [73, 80, 75]를 선언\n","new_var =  torch.FloatTensor([[73, 80, 75]]) \n","# 입력한 값 [73, 80, 75]에 대해서 예측값 y를 리턴받아서 pred_y에 저장\n","pred_y = model(new_var) \n","print(\"훈련 후 입력이 73, 80, 75일 때의 예측값 :\", pred_y) "],"execution_count":17,"outputs":[{"output_type":"stream","text":["훈련 후 입력이 73, 80, 75일 때의 예측값 : tensor([[155.2438]], grad_fn=<AddmmBackward>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"W8FBc8IeAUP8","colab_type":"text"},"source":["# Logistic Regression"]},{"cell_type":"markdown","metadata":{"id":"fiHlX_4CAaeV","colab_type":"text"},"source":["#### 수작업으로 진행"]},{"cell_type":"code","metadata":{"id":"HMUKgLWc9R4p","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599892235094,"user_tz":-540,"elapsed":808,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim"],"execution_count":18,"outputs":[]},{"cell_type":"code","metadata":{"id":"MFhXyFh_Ah_5","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1599892243730,"user_tz":-540,"elapsed":853,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"165f8f55-40a2-45f7-b3e3-3bdcbcad2d0c"},"source":["torch.manual_seed(0)"],"execution_count":19,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<torch._C.Generator at 0x7fbb0dd4d0d8>"]},"metadata":{"tags":[]},"execution_count":19}]},{"cell_type":"code","metadata":{"id":"eicm8pKzAkGG","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599892261525,"user_tz":-540,"elapsed":794,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["x_data = [[1, 2], [2, 3], [3, 1], [4, 3], [5, 3], [6, 2]]\n","y_data = [[0], [0], [0], [1], [1], [1]]\n","x_train = torch.FloatTensor(x_data)\n","y_train = torch.FloatTensor(y_data)"],"execution_count":20,"outputs":[]},{"cell_type":"code","metadata":{"id":"-zoAcX7jAodE","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599892298633,"user_tz":-540,"elapsed":813,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["W = torch.zeros((x_train.shape[1], 1), requires_grad=True) # 크기는 2 x 1\n","b = torch.zeros(1, requires_grad=True)"],"execution_count":21,"outputs":[]},{"cell_type":"code","metadata":{"id":"h5HnaMpOAxgl","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":122},"executionInfo":{"status":"ok","timestamp":1599892328535,"user_tz":-540,"elapsed":773,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"941aa322-e749-4b07-b1e8-4b7658f679d7"},"source":["hypothesis = 1 / (1 + torch.exp(-(x_train.matmul(W) + b))) # sigmoid 직접 만들기\n","print(hypothesis) "],"execution_count":22,"outputs":[{"output_type":"stream","text":["tensor([[0.5000],\n","        [0.5000],\n","        [0.5000],\n","        [0.5000],\n","        [0.5000],\n","        [0.5000]], grad_fn=<MulBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"IIyt1F2AA40e","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":122},"executionInfo":{"status":"ok","timestamp":1599892365304,"user_tz":-540,"elapsed":838,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"40820e0e-3813-402b-ce5d-75799638c1b2"},"source":["hypothesis = torch.sigmoid(x_train.matmul(W) + b) # 이미 구현된 함수 이용하기\n","print(hypothesis)"],"execution_count":23,"outputs":[{"output_type":"stream","text":["tensor([[0.5000],\n","        [0.5000],\n","        [0.5000],\n","        [0.5000],\n","        [0.5000],\n","        [0.5000]], grad_fn=<SigmoidBackward>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7VQxFzWFBGXJ","colab_type":"text"},"source":["grad_fn 이 다름"]},{"cell_type":"markdown","metadata":{"id":"UMJS3qc9BPEI","colab_type":"text"},"source":["#### 비용 함수(Cost function)\n","\n","\n","이제 로지스틱 회귀의 가설이 H(x)=sigmoid(Wx+b)인 것은 알았습니다. 이제 최적의 W와 b를 찾을 수 있는 비용 함수(cost function)를 정의해야 합니다. 그런데 혹시 앞서 선형 회귀에서 배운 비용 함수인 평균 제곱 오차(Mean Square Error, MSE)를 로지스틱 회귀의 비용 함수로 그냥 사용하면 안 될까요?\n","\n","다음은 선형 회귀에서 사용했던 평균 제곱 오차의 수식입니다.\n","\n","cost(W,b)=1n∑i=1n[y(i)−H(x(i))]2\n","위의 비용 함수 수식에서 가설은 이제 H(x)=Wx+b가 아니라 H(x)=sigmoid(Wx+b)입니다. 그리고 이 비용 함수를 미분하면 선형 회귀때와 달리 다음과 같이 비볼록(non-convex) 형태의 그래프가 나옵니다.\n","\n","![image.png](data:image/png;base64,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)\n","\n","\n","위와 같은 그래프에 경사 하강법을 사용할 경우의 문제점은 경사 하강법이 오차가 최소값이 되는 구간에 도착했다고 판단한 그 구간이 실제 오차가 완전히 최소값이 되는 구간이 아닐 수 있다는 점입니다. 사람이 등산 후에 산을 내려올 때도, 가파른 경사를 내려오다가 넓은 평지가 나오면 순간적으로 다 내려왔다고 착각할 수 있습니다. 하지만 실제로는 그곳이 다 내려온 것이 아니라 잠깐 평지가 나왔을 뿐이라면 길을 더 찾아서 더 내려가야 할 겁니다. 모델도 마찬가지로 실제 오차가 최소가 되는 구간을 찾을 수 있도록 도와주어야 합니다. 만약, 실제 최소가 되는 구간을 잘못 판단하면 최적의 가중치 W가 아닌 다른 값을 택해 모델의 성능이 더 오르지 않습니다.\n","\n","이를 전체 함수에 걸쳐 최소값인 글로벌 미니멈(Global Minimum)이 아닌 특정 구역에서의 최소값인 로컬 미니멈(Local Minimum)에 도달했다고 합니다. 이는 cost가 최소가 되는 가중치 W를 찾는다는 비용 함수의 목적에 맞지 않습니다.\n","\n","시그모이드 함수의 특징은 함수의 출력값이 0과 1사이의 값이라는 점입니다. 즉, 실제값이 1일 때 예측값이 0에 가까워지면 오차가 커져야 하며, 실제값이 0일 때, 예측값이 1에 가까워지면 오차가 커져야 합니다. 그리고 이를 충족하는 함수가 바로 로그 함수입니다. 다음은 y=0.5에 대칭하는 두 개의 로그 함수 그래프입니다.\n","\n","![image.png](data:image/png;base64,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)\n","\n","실제값이 1일 때의 그래프를 주황색 선으로 표현하였으며, 실제값이 0일 때의 그래프를 초록색 선으로 표현하였습니다. 실제값이 1이라고 해봅시다. 이 경우, 예측값인 H(x)의 값이 1이면 오차가 0이므로 당연히 cost는 0이 됩니다. 반면, H(x)가 0으로 수렴하면 cost는 무한대로 발산합니다. 실제값이 0인 경우는 그 반대로 이해하면 됩니다. 이 두 개의 로그 함수를 식으로 표현하면 다음과 같습니다.\n","\n","if y=1→cost(H(x),y)=−log(H(x))\n","if y=0→cost(H(x),y)=−log(1−H(x))\n","y의 실제값이 1일 때 −logH(x) 그래프를 사용하고 y의 실제값이 0일 때 −log(1−H(X)) 그래프를 사용해야 합니다.\n","이는 다음과 같이 하나의 식으로 통합할 수 있습니다.\n","\n","# cost(H(x),y)=−[ylogH(x)+(1−y)log(1−H(x))]\n","\n","왜 위 식이 두 개의 식을 통합한 식이라고 볼 수 있을까요? 실제값 y가 1이라고하면 덧셈 기호를 기준으로 우측의 항이 없어집니다. 반대로 실제값 y가 0이라고 하면 덧셈 기호를 기준으로 좌측의 항이 없어집니다. 선형 회귀에서는 모든 오차의 평균을 구해 평균 제곱 오차를 사용했었습니다. 마찬가지로 여기에서도 모든 오차의 평균을 구합니다.\n","\n","# cost(W)= −1/n * ∑i=1n[y(i)logH(x(i))+(1−y(i))log(1−H(x(i)))]\n","\n","정리하면, 위 비용 함수는 실제값 y와 예측값 H(x)의 차이가 커지면 cost가 커지고, 실제값 y와 예측값 H(x)의 차이가 작아지면 cost는 작아집니다. 이제 위 비용 함수에 대해서 경사 하강법을 수행하면서 최적의 가중치 W를 찾아갑니다.\n","\n","W:=W−α∂[cost(W)] / ∂W"]},{"cell_type":"code","metadata":{"id":"M51cFlYLBBut","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":175},"executionInfo":{"status":"ok","timestamp":1599892787748,"user_tz":-540,"elapsed":771,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"d7815a0d-0a46-4128-f909-086bcc60fbe7"},"source":["# 수작업\n","losses = -(y_train * torch.log(hypothesis) + \n","           (1 - y_train) * torch.log(1 - hypothesis))\n","cost = losses.mean()\n","print(f'losses:\\n{losses}\\n cost:\\n{cost}')"],"execution_count":24,"outputs":[{"output_type":"stream","text":["losses:\n","tensor([[0.6931],\n","        [0.6931],\n","        [0.6931],\n","        [0.6931],\n","        [0.6931],\n","        [0.6931]], grad_fn=<NegBackward>)\n"," cost:\n","0.6931471824645996\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Z8v3X9ifCo7S","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1599892830416,"user_tz":-540,"elapsed":820,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"f1da1cf0-0224-493c-f926-c95340454745"},"source":["# 구현된 함수 이용하기\n","F.binary_cross_entropy(hypothesis, y_train)"],"execution_count":25,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor(0.6931, grad_fn=<BinaryCrossEntropyBackward>)"]},"metadata":{"tags":[]},"execution_count":25}]},{"cell_type":"code","metadata":{"id":"rqIlUEtkCzVt","colab_type":"code","colab":{}},"source":[""],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"RKGvXrBNDEK-","colab_type":"text"},"source":["#### 학습하기"]},{"cell_type":"code","metadata":{"id":"kNu9TkD5DNDW","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":545},"executionInfo":{"status":"ok","timestamp":1599894185134,"user_tz":-540,"elapsed":987,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"03d478f4-a58c-4288-baf2-4af0553639c7"},"source":["# 모델 초기화\n","W = torch.zeros((2, 1), requires_grad=True)\n","b = torch.zeros(1, requires_grad=True)\n","# optimizer 설정\n","optimizer = optim.SGD([W, b], lr=1)\n","\n","nb_epochs = 1000\n","for epoch in range(1,nb_epochs + 1):\n","\n","    # Cost 계산\n","    hypothesis = torch.sigmoid(x_train.matmul(W) + b)\n","    cost = F.binary_cross_entropy(hypothesis, y_train)\n","\n","    # cost로 H(x) 개선\n","    optimizer.zero_grad()\n","    cost.backward()\n","    optimizer.step()\n","\n","    # 100번마다 로그 출력\n","    if epoch % 100 == 0:\n","        print('Epoch {:4d}/{} Cost: {:.6f}'.format(\n","            epoch, nb_epochs, cost.item()\n","        ))\n","\n","        prediction = hypothesis >= torch.FloatTensor([0.5]) # 예측값이 0.5를 넘으면 True로 간주\n","        correct_prediction = prediction.float() == y_train # 실제값과 일치하는 경우만 True로 간주\n","        accuracy = correct_prediction.sum().item() / len(correct_prediction) # 정확도를 계산\n","        print('Epoch {:4d}/{} Cost: {:.6f} Accuracy {:2.2f}%'.format( # 각 에포크마다 정확도를 출력\n","            epoch, nb_epochs, cost.item(), accuracy * 100,\n","        ))\n","\n","        print()"],"execution_count":30,"outputs":[{"output_type":"stream","text":["Epoch  100/1000 Cost: 0.135644\n","Epoch  100/1000 Cost: 0.135644 Accuracy 100.00%\n","\n","Epoch  200/1000 Cost: 0.080964\n","Epoch  200/1000 Cost: 0.080964 Accuracy 100.00%\n","\n","Epoch  300/1000 Cost: 0.058062\n","Epoch  300/1000 Cost: 0.058062 Accuracy 100.00%\n","\n","Epoch  400/1000 Cost: 0.045398\n","Epoch  400/1000 Cost: 0.045398 Accuracy 100.00%\n","\n","Epoch  500/1000 Cost: 0.037327\n","Epoch  500/1000 Cost: 0.037327 Accuracy 100.00%\n","\n","Epoch  600/1000 Cost: 0.031720\n","Epoch  600/1000 Cost: 0.031720 Accuracy 100.00%\n","\n","Epoch  700/1000 Cost: 0.027592\n","Epoch  700/1000 Cost: 0.027592 Accuracy 100.00%\n","\n","Epoch  800/1000 Cost: 0.024422\n","Epoch  800/1000 Cost: 0.024422 Accuracy 100.00%\n","\n","Epoch  900/1000 Cost: 0.021911\n","Epoch  900/1000 Cost: 0.021911 Accuracy 100.00%\n","\n","Epoch 1000/1000 Cost: 0.019871\n","Epoch 1000/1000 Cost: 0.019871 Accuracy 100.00%\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"fPpKHhAdI8FZ","colab_type":"text"},"source":["# Softmax Regression"]},{"cell_type":"markdown","metadata":{"id":"xs3HOMbyJqPb","colab_type":"text"},"source":["정수 인코딩과 달리 원-핫 인코딩은 분류 문제 모든 클래스 간의 관계를 균등하게 분배\n","\n","원-핫 벡터의 관계의 무작위성은 때로는 단어의 유사성을 구할 수 없다는 단점으로 언급되기도 합니다.\n","\n","![image.png](data:image/png;base64,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)"]},{"cell_type":"markdown","metadata":{"id":"iWphkMLlKtC_","colab_type":"text"},"source":["https://wikidocs.net/59427\n","\n","Cross Entropy 설명"]},{"cell_type":"code","metadata":{"id":"N_RiZagdDgvK","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":87},"executionInfo":{"status":"ok","timestamp":1599897618744,"user_tz":-540,"elapsed":795,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"e7c8065b-b3aa-4c66-fed7-7a5357e20aaf"},"source":["z = torch.rand(3, 5, requires_grad=True)\n","y = torch.randint(5, (3,)).long() # 총 5가지의 라벨 중 training data가 3개니깐 3 가지 선정\n","# 모든 원소가 0의 값을 가진 3 × 5 텐서 생성\n","\n","hypothesis = F.softmax(z, dim=1)\n","print(hypothesis)\n","print(hypothesis.sum(dim=1))"],"execution_count":35,"outputs":[{"output_type":"stream","text":["tensor([[0.1280, 0.2634, 0.2142, 0.2184, 0.1760],\n","        [0.1955, 0.2749, 0.1584, 0.1760, 0.1952],\n","        [0.2335, 0.2283, 0.1364, 0.1673, 0.2345]], grad_fn=<SoftmaxBackward>)\n","tensor([1., 1., 1.], grad_fn=<SumBackward1>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"eJd7Aog4VrwJ","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":193},"executionInfo":{"status":"ok","timestamp":1599898081393,"user_tz":-540,"elapsed":818,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"d87ca4ef-e059-4fab-d828-410756111f6d"},"source":["# High level\n","print(torch.log(F.softmax(z, dim=1)))\n","print(F.log_softmax(z, dim=1))\n","print(torch.log(F.softmax(z, dim=1))==F.log_softmax(z,dim=1))"],"execution_count":43,"outputs":[{"output_type":"stream","text":["tensor([[-2.0557, -1.3340, -1.5407, -1.5215, -1.7375],\n","        [-1.6323, -1.2913, -1.8428, -1.7372, -1.6337],\n","        [-1.4547, -1.4770, -1.9919, -1.7882, -1.4504]], grad_fn=<LogBackward>)\n","tensor([[-2.0557, -1.3340, -1.5407, -1.5215, -1.7375],\n","        [-1.6323, -1.2913, -1.8428, -1.7372, -1.6337],\n","        [-1.4547, -1.4770, -1.9919, -1.7882, -1.4504]],\n","       grad_fn=<LogSoftmaxBackward>)\n","tensor([[ True,  True,  True,  True,  True],\n","        [False,  True, False, False, False],\n","        [False, False,  True, False,  True]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"tfeqx5tIUX7e","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":193},"executionInfo":{"status":"ok","timestamp":1599897621031,"user_tz":-540,"elapsed":772,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"213054fa-1a67-488b-c942-5a79e315444b"},"source":["print(y)\n","y_one_hot = torch.zeros_like(hypothesis) #(5,3)이 생성되겠지\n","print(y_one_hot)\n","print(y.unsqueeze(1))\n","y_one_hot.scatter_(1, y.unsqueeze(1), 1)\n","print(y_one_hot)"],"execution_count":36,"outputs":[{"output_type":"stream","text":["tensor([4, 3, 1])\n","tensor([[0., 0., 0., 0., 0.],\n","        [0., 0., 0., 0., 0.],\n","        [0., 0., 0., 0., 0.]])\n","tensor([[4],\n","        [3],\n","        [1]])\n","tensor([[0., 0., 0., 0., 1.],\n","        [0., 0., 0., 1., 0.],\n","        [0., 1., 0., 0., 0.]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"3BAfYC4uVPqO","colab_type":"text"},"source":["그리고 scatter의 첫번째 인자로 dim=1에 대해서 수행하라고 알려주고, 세번째 인자에 숫자 1을 넣어주므로서 두번째 인자인 y_unsqeeze(1)이 알려주는 위치에 숫자 1을 넣도록 합니다"]},{"cell_type":"code","metadata":{"id":"MVntHbm3VAZr","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":87},"executionInfo":{"status":"ok","timestamp":1599898264231,"user_tz":-540,"elapsed":818,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"6827d0fc-b8f4-4514-c01f-5620224b84ed"},"source":["# hypothesis = F.softmax(z, dim=1)\n","cost = (y_one_hot * -torch.log(hypothesis)).sum(dim=1).mean()\n","print(cost)\n","\n","# 두번째 수식\n","cost = (y_one_hot * - F.log_softmax(z, dim=1)).sum(dim=1).mean()\n","print(cost)\n","\n","# 세번째 수식\n","cost=F.nll_loss(F.log_softmax(z, dim=1), y)\n","print(cost)\n","\n","# 네번째 수식\n","cost=F.cross_entropy(z, y) # 그냥 때려넣어 버렸음\n","print(cost)"],"execution_count":44,"outputs":[{"output_type":"stream","text":["tensor(1.6506, grad_fn=<MeanBackward0>)\n","tensor(1.6506, grad_fn=<MeanBackward0>)\n","tensor(1.6506, grad_fn=<NllLossBackward>)\n","tensor(1.6506, grad_fn=<NllLossBackward>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"Q23xBqFOYNeN","colab_type":"text"},"source":["####>> 토치비전(torchvision) 소개하기\n","본격적인 실습에 들어가기에 앞서 토치비전(torchvision)이라는 도구를 설명하겠습니다. torchvision은 유명한 데이터셋들, 이미 구현되어져 있는 유명한 모델들, 일반적인 이미지 전처리 도구들을 포함하고 있는 패키지입니다. 아래의 링크는 torchvision에 어떤 데이터셋들(datasets)과 모델들(models) 그리고 어떤 전처리 방법들(transforms)을 제공하고 있는지 보여줍니다."]},{"cell_type":"markdown","metadata":{"id":"jAwCxWdCYFFD","colab_type":"text"},"source":["### MNIST 구현하기"]},{"cell_type":"code","metadata":{"id":"mGvUYex7Vd3d","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599900210611,"user_tz":-540,"elapsed":820,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["import torch\n","import torch.nn.functional as F\n","import torchvision.datasets as dsets\n","import torchvision.transforms as transforms\n","from torch.utils.data import DataLoader\n","import torch.nn as nn\n","import matplotlib.pyplot as plt\n","import random"],"execution_count":25,"outputs":[]},{"cell_type":"code","metadata":{"id":"5cJ0HjrxYVkL","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1599898588016,"user_tz":-540,"elapsed":1077,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"fc42d5dd-ba48-4801-c8a7-9786b0b4e62e"},"source":["USE_CUDA = torch.cuda.is_available() # GPU를 사용가능하면 True, 아니라면 False를 리턴\n","device = torch.device(\"cuda\" if USE_CUDA else \"cpu\") # GPU 사용 가능하면 사용하고 아니면 CPU 사용\n","print(\"다음 기기로 학습합니다:\", device)"],"execution_count":2,"outputs":[{"output_type":"stream","text":["다음 기기로 학습합니다: cuda\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"jKXi5Gq8Yw7y","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599898702361,"user_tz":-540,"elapsed":826,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["# for reproducibility\n","random.seed(0)\n","torch.manual_seed(0)\n","if device == 'cuda':\n","    torch.cuda.manual_seed_all(0)"],"execution_count":4,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"YxouAhs7gU_k","colab_type":"text"},"source":["#### 데이터 불러오기"]},{"cell_type":"code","metadata":{"id":"64-el6phZPBh","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":411,"referenced_widgets":["4c689130f139474e8b123d34817e2207","2f718961153e4f1f8453196c857d69c7","33bbf11e23fb4acab7c23e882530bdfa","b13bdd91a8534c6fafb18405acdaf226","6e99527ed40d4e9c95da0fc3b00ed05c","f2bf1ee0854242c3a527527dbc870559","4e9b79237d15432aa836dfd6716c1580","3e562f92f7ac46bea89c84f15e4fea29","123ab39d40e64a8299c0ffeb6c74530c","b1220beb3d18423ab2fbc68f227f28cb","bd30eee05f154fb4aea783bb9bcb8ad4","cd5365e2045b47339c2fd43682aa566f","ba156d5ce61340ec97dc0cf6802f3c57","dc54634445e84e139c0ece23b23012b9","f322ead3688a4dd4a45de5185fad6f2e","3e5e151091b1414f85d899f8a42c098c","f645c67680fd45d5bf6181fe9b9236a5","c276e51499e54f5d91405c6fc3e2e722","b9b04b3983d94ba689731821e9e3f155","f98d01c21f0d4a94ac4c655363f2b29c","4f16c5f45bb048cf8edf703268194c0a","ac92072872654d23ade769b6ada7eb7d","7b8d689d6e274914b2734d5d15506bbf","7d62711a3e334c12ab272630894522b5","f533b74439534c45bfed3d7bde776f0f","6d4c74ae249e445eaa56b14321f382de","a493172a43714ac7a49c35af1eab08ab","5f08ff1972d241d093b679e87aff7f08","3d70fc9b37194ae7bf3778c6b9d7e257","5b12b2fd84ae41e8a27b9b2b031b5bb6","900b0399c23644f8aa01edf40fb633e0","cf87a933420d46578f3a7738cea965ba"]},"executionInfo":{"status":"ok","timestamp":1599898776179,"user_tz":-540,"elapsed":3607,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"769f8b97-3ce1-4f0e-a791-a10df3713b92"},"source":["# MNIST dataset\n","mnist_train = dsets.MNIST(root='MNIST_data/',\n","                          train=True,\n","                          transform=transforms.ToTensor(),\n","                          download=True)\n","\n","mnist_test = dsets.MNIST(root='MNIST_data/',\n","                         train=False,\n","                         transform=transforms.ToTensor(),\n","                         download=True)"],"execution_count":6,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to MNIST_data/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4c689130f139474e8b123d34817e2207","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting MNIST_data/MNIST/raw/train-images-idx3-ubyte.gz to MNIST_data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to MNIST_data/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"123ab39d40e64a8299c0ffeb6c74530c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting MNIST_data/MNIST/raw/train-labels-idx1-ubyte.gz to MNIST_data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to MNIST_data/MNIST/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"f645c67680fd45d5bf6181fe9b9236a5","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting MNIST_data/MNIST/raw/t10k-images-idx3-ubyte.gz to MNIST_data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to MNIST_data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n","\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"f533b74439534c45bfed3d7bde776f0f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting MNIST_data/MNIST/raw/t10k-labels-idx1-ubyte.gz to MNIST_data/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"ey07jFpyZbut","colab_type":"text"},"source":["첫번째 인자 root는 MNIST 데이터를 다운로드 받을 경로입니다. 두번째 인자 train은 인자로 True를 주면, MNIST의 훈련 데이터를 리턴받으며 False를 주면 테스트 데이터를 리턴받습니다. 세번째 인자 transform은 현재 데이터를 파이토치 텐서로 변환해줍니다. 네번째 인자 download는 해당 경로에 MNIST 데이터가 없다면 다운로드 받겠다는 의미입니다."]},{"cell_type":"code","metadata":{"id":"fPUbWxcJZogK","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":140},"executionInfo":{"status":"ok","timestamp":1599899615640,"user_tz":-540,"elapsed":810,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"318d5874-3548-42e6-e26d-c956984f1b87"},"source":["# ---.data.shape을 해야 모양을 불 수 있음\n","print(f'mnist_train.data.shape: {mnist_train.data.shape}')\n","print(f'mnist_train.targets.shape : {mnist_train.targets.shape}')\n","print(f'mnist_test.data.shape: {mnist_test.data.shape}')\n","print(f'mnist_test.targets.shape: {mnist_test.targets.shape}')\n","\n","data_shape=mnist_train.data.shape[1:]\n","print(data_shape)\n","\n","#target의 종류를 보기 위해선 data.targets.unique(return_counts=True)[0]\n","target_class=mnist_train.targets.unique(return_counts=True)\n","class_num = len(target_class[0])\n","print(target_class[0])\n","print(class_num)"],"execution_count":21,"outputs":[{"output_type":"stream","text":["mnist_train.data.shape: torch.Size([60000, 28, 28])\n","mnist_train.targets.shape : torch.Size([60000])\n","mnist_test.data.shape: torch.Size([10000, 28, 28])\n","mnist_test.targets.shape: torch.Size([10000])\n","torch.Size([28, 28])\n","tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])\n","10\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"coDIoV9RgeMl","colab_type":"text"},"source":["#### 기본 설정 : 웨이트 초기값(linear()), optimizer, epoch 수, 배치 수 등"]},{"cell_type":"code","metadata":{"id":"3eLL7p2CZKYg","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599898710963,"user_tz":-540,"elapsed":800,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["# hyperparameters\n","training_epochs = 15\n","batch_size = 100"],"execution_count":5,"outputs":[]},{"cell_type":"code","metadata":{"id":"CODfmz7cZnbp","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599898815327,"user_tz":-540,"elapsed":783,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["# dataset loader\n","data_loader = DataLoader(dataset=mnist_train,\n","                                          batch_size=batch_size, # 배치 크기는 100\n","                                          shuffle=True,\n","                                          drop_last=True)"],"execution_count":7,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"qz-Gm02rZpVj","colab_type":"text"},"source":["이때 DataLoader에는 4개의 인자가 있습니다. 첫번째 인자인 dataset은 로드할 대상을 의미하며, 두번째 인자인 batch_size는 배치 크기, shuffle은 매 epoch마다 미니 배치를 셔플할 것인지의 여부, drop_last는 마지막 배치를 버릴 것인지를 의미합니다.\n","\n","* droplast는 다른 미니 배치보다 개수가 적은 마지막 배치를 경사 하강법에 사용하여 마지막 배치가 상대적으로 과대 평가되는 현상을 막아줍니다."]},{"cell_type":"code","metadata":{"id":"LP58LS-aaEoz","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599899636174,"user_tz":-540,"elapsed":10749,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["# MNIST data image of shape 28 * 28 = 784\n","linear = nn.Linear(data_shape[0]*data_shape[1], class_num, bias=True).to(device)"],"execution_count":22,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"DyDy8_eDazOe","colab_type":"text"},"source":["GPU를 사용하려면 to('cuda')를 해 줄 필요가 있습니다. 아무것도 지정하지 않은 경우에는 CPU 연산이라고 보면 됩니다."]},{"cell_type":"code","metadata":{"id":"8LdSJ7HFc3OJ","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1599900265921,"user_tz":-540,"elapsed":867,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}}},"source":["# cost=F.cross_entropy(z, y)\n","criterion = nn.CrossEntropyLoss().to(device) # 내부적으로 소프트맥스 함수를 포함하고 있음.\n","# criterion=F.cross_entropy(~~~).to(device) #이건 ~~~이 부분에 사이즈를 정해주어야 하기 때문에 위에걸 사용\n","optimizer = torch.optim.SGD(linear.parameters(), lr=0.1)"],"execution_count":29,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"8Pmww0DTdKUn","colab_type":"text"},"source":["앞서 소프트맥스 회귀를 배울 때는 torch.nn.functional.cross_entropy()를 사용하였으나 여기서는 torch.nn.CrossEntropyLoss()을 사용하고 있습니다. 둘 다 파이토치에서 제공하는 크로스 엔트로피 함수로 둘 다 소프트맥스 함수를 포함하고 있습니다."]},{"cell_type":"markdown","metadata":{"id":"eMmzBB4FgwKz","colab_type":"text"},"source":["#### 학습"]},{"cell_type":"code","metadata":{"id":"GvPD1eM6dJFx","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":298},"executionInfo":{"status":"ok","timestamp":1599900489238,"user_tz":-540,"elapsed":63908,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"605adc27-846d-471d-a0e3-c4a023d0e77a"},"source":["for epoch in range(training_epochs): # 앞서 training_epochs의 값은 15로 지정함.\n","    avg_cost = 0\n","    total_batch = len(data_loader)\n","\n","    for X, Y in data_loader:\n","        # 배치 크기가 100이므로 아래의 연산에서 X는 (100, 784)의 텐서가 된다.\n","        X = X.view(-1, 28 * 28).to(device)\n","        # 레이블은 원-핫 인코딩이 된 상태가 아니라 0 ~ 9의 정수.\n","        Y = Y.to(device)\n","\n","        optimizer.zero_grad()\n","        # linear = nn.Linear(data_shape[0]*data_shape[1], class_num, bias=True).to(device)\n","        hypothesis = linear(X)\n","        # criterion = nn.CrossEntropyLoss().to(device\n","        cost = criterion(hypothesis, Y) #cost는 dot product를 진행한 거 가지고 사용해야함\n","        cost.backward()\n","        optimizer.step()\n","\n","        avg_cost += cost / total_batch\n","\n","    print('Epoch:', '%04d' % (epoch + 1), 'cost =', '{:.9f}'.format(avg_cost))\n","\n","print('Learning finished')"],"execution_count":30,"outputs":[{"output_type":"stream","text":["Epoch: 0001 cost = 0.535838962\n","Epoch: 0002 cost = 0.359289110\n","Epoch: 0003 cost = 0.331339777\n","Epoch: 0004 cost = 0.316344410\n","Epoch: 0005 cost = 0.307154119\n","Epoch: 0006 cost = 0.300422341\n","Epoch: 0007 cost = 0.295070112\n","Epoch: 0008 cost = 0.290760607\n","Epoch: 0009 cost = 0.287613183\n","Epoch: 0010 cost = 0.284398794\n","Epoch: 0011 cost = 0.282051653\n","Epoch: 0012 cost = 0.279836893\n","Epoch: 0013 cost = 0.277626127\n","Epoch: 0014 cost = 0.276017219\n","Epoch: 0015 cost = 0.274279028\n","Learning finished\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"N7Ks-GFUgzet","colab_type":"text"},"source":["#### 테스트"]},{"cell_type":"code","metadata":{"id":"GibPFk8-fxwj","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":423},"executionInfo":{"status":"ok","timestamp":1599901068340,"user_tz":-540,"elapsed":1195,"user":{"displayName":"‍김도윤[ 학부재학 / 산업경영공학부 ]","photoUrl":"","userId":"10791284398836833218"}},"outputId":"4754ca48-79db-4b7f-de7d-1ab1455c96fe"},"source":["with torch.no_grad(): # torch.no_grad()를 하면 gradient 계산을 수행하지 않는다.\n","    X_test = mnist_test.test_data.view(-1, data_shape[0]*data_shape[1]).float().to(device)\n","    Y_test = mnist_test.test_labels.to(device) \n","\n","    prediction = linear(X_test)\n","    correct_prediction = torch.argmax(prediction, 1) == Y_test\n","    \n","    print(correct_prediction)\n","    print(correct_prediction.float())\n","    #어차피 softmax 함수 결과값의 크기는 그전에 dot product의 크기와 비례하기 때문이다.\n","\n","    accuracy = correct_prediction.float().mean()\n","    print('Accuracy:', accuracy.item())\n","\n","    # MNIST 테스트 데이터에서 무작위로 하나를 뽑아서 예측을 해본다\n","    r = random.randint(0, len(mnist_test) - 1)\n","    X_single_data = mnist_test.test_data[r:r + 1].view(-1, 28 * 28).float().to(device)\n","    Y_single_data = mnist_test.test_labels[r:r + 1].to(device)\n","\n","    print('Label: ', Y_single_data.item())\n","    single_prediction = linear(X_single_data)\n","    print('Prediction: ', torch.argmax(single_prediction, 1).item())\n","\n","    plt.imshow(mnist_test.test_data[r:r + 1].view(28, 28), cmap='Greys', interpolation='nearest')\n","    plt.show()\n"],"execution_count":33,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:60: UserWarning: test_data has been renamed data\n","  warnings.warn(\"test_data has been renamed data\")\n","/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:50: UserWarning: test_labels has been renamed targets\n","  warnings.warn(\"test_labels has been renamed targets\")\n"],"name":"stderr"},{"output_type":"stream","text":["tensor([ True,  True,  True,  ...,  True, False,  True], device='cuda:0')\n","tensor([1., 1., 1.,  ..., 1., 0., 1.], device='cuda:0')\n","Accuracy: 0.8815999627113342\n","Label:  2\n","Prediction:  2\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"H0UXHuGtiieV","colab_type":"text"},"source":["If *interpolation* is the default 'antialiased', then 'nearest'  \n","    interpolation is used if the image is upsampled by more than a  \n","    factor of three (i.e. the number of display pixels is at least  \n","    three times the size of the data array).  If the upsampling rate is  \n","    smaller than 3, or the image is downsampled, then 'hanning'  \n","    interpolation is used to act as an anti-aliasing filter, unless the  \n","    image happens to be upsampled by exactly a factor of two or one.  \n"]},{"cell_type":"code","metadata":{"id":"gpNWGF3giM0x","colab_type":"code","colab":{}},"source":[""],"execution_count":null,"outputs":[]}]}